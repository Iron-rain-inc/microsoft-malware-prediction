---
layout: post
title:  "Notebook!"
date:   2019-03-10 11:59:13 +1100
categories: jekyll update
---

# Microsoft Malware Detection

## Project Overview
Microsoft have engaged with data scientists world-wide to develop a model for the purpose of detecting malware vulnerable computers. 

Microsoft have provided a dataset as one arm of a strategy to detect malware vulnerabilities. 

This project will use the data provided to predict whether a computer is more or less likely vulnerable to a malware attack. 

Microsoft have provided a training dataset which contains the field `HasDetections`, this field indicates whether or not a computer has detected malware. 

A test dataset to perform predictions upon has also been provided, the model will be run against this dataset to produce predictions for the customer. 

The dataset has been provided by Microsoft for use in the following Kaggle competition https://www.kaggle.com/c/microsoft-malware-prediction 

## Problem Statement
Billions of computers are vulnerable to a malware attack, this is a preventable problem that this project aims to contribute towards. 

Using the provided datasets this project will predict computers that are vulerable to a malware attack and present this data in a format that would allow the vendor or customer to take action in preventing an attack taking place. 

## Metrics

This project will use a supervised model to obtain results, metrics that will be used include but are not limited to:
* Confusion Matrix
* Accuracy Score
* Precision Score
* Recall Score
* Specificity 
* F1 Score


```python
import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

from sklearn import preprocessing
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.preprocessing import LabelEncoder
from sklearn.tree import DecisionTreeClassifier
from collections import defaultdict
import lightgbm as lgb

from itertools import product
from sklearn.metrics import accuracy_score

import pickle
import requests
import json
```


```python
# Load the training data into a dataframe
train_data = pd.read_csv('../dataset/train.csv')
```


```python
data_point_list = []
data_point_list.append(train_data.shape[0] * train_data.shape[1])
```

The first steps are to look at the data types contained in our training data and determine the wholeness of our data


```python
# Look at the dtypes 
train_data.dtypes.value_counts()
```




    float64    36
    object     30
    int64      17
    dtype: int64




```python
train_data.dtypes.value_counts().plot.pie()
```




    <matplotlib.axes._subplots.AxesSubplot at 0x7f0d55bb5c18>




![png](output_8_1.png)



```python
missing_percentages = pd.DataFrame(100 - ((train_data.count() / train_data.shape[0]) * 100), columns=['Missing Percentage'])
```


```python
# Look at the significant missing data
missing_percentages[missing_percentages['Missing Percentage'] > 10]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Missing Percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>DefaultBrowsersIdentifier</th>
      <td>95.141637</td>
    </tr>
    <tr>
      <th>OrganizationIdentifier</th>
      <td>30.841487</td>
    </tr>
    <tr>
      <th>PuaMode</th>
      <td>99.974119</td>
    </tr>
    <tr>
      <th>SmartScreen</th>
      <td>35.610795</td>
    </tr>
    <tr>
      <th>Census_ProcessorClass</th>
      <td>99.589407</td>
    </tr>
    <tr>
      <th>Census_InternalBatteryType</th>
      <td>71.046809</td>
    </tr>
    <tr>
      <th>Census_IsFlightingInternal</th>
      <td>83.044030</td>
    </tr>
    <tr>
      <th>Census_ThresholdOptIn</th>
      <td>63.524472</td>
    </tr>
    <tr>
      <th>Census_IsWIMBootEnabled</th>
      <td>63.439038</td>
    </tr>
  </tbody>
</table>
</div>



### Data Types
Looking at the data types there is a breakdown of float64, int64 and object data.
The next step is to inspect the number data and determine if any of them need to be recast as objects. 

### Missing Data
The view of missing data is only showing columns with more than 1% of missing data, I've deemed less than 10% a trivial loss for this dataset.

The columns with more than a 10% loss need to be inspected to see if they are worth keeping. Before this begins though the fields, `DefaultBrowserIdentifier`, `Census_processorClass` & `PuaMode` can be dropped as there is no sustainable way to keep them. 

### Missing Data Review
To review the columns before deciding to drop them the data descriptor is used:

* `OrganizationIdentifier` - ID for the organization the machine belongs in, organization ID is mapped to both specific companies and broad industries .
* `SmartScreen` - A cloud-based anti-phishing and anti-malware component.
* `Census_InternalBatteryType` - Internal battery type
* `Census_IsFlightingInternal` - Related to OS releases
* `Census_ThresholdOptIn` - NA
* `Census_IsWIMBootEnabled` - Allows a Windows image to be compressed, reducing usage space.

Several are not described with the data source and required additional investigation, of these fields the most important at a cursory glance is SmartScreen. 
The missing values of SmartScreen will be dropped and missing values checked again.

SmartScreen will not have missing values substituted as it could lead to errors in the results, instead the dataset will be trimmed. 


```python
ss_dropped = train_data.dropna(subset=['SmartScreen'])
```


```python
missing_percentages = pd.DataFrame(100 - ((ss_dropped.count() / ss_dropped.shape[0]) * 100), columns=['Missing Percentage'])
```


```python
missing_percentages[missing_percentages['Missing Percentage'] > 10]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Missing Percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>DefaultBrowsersIdentifier</th>
      <td>95.223947</td>
    </tr>
    <tr>
      <th>OrganizationIdentifier</th>
      <td>31.069661</td>
    </tr>
    <tr>
      <th>PuaMode</th>
      <td>99.974445</td>
    </tr>
    <tr>
      <th>Census_ProcessorClass</th>
      <td>99.471318</td>
    </tr>
    <tr>
      <th>Census_InternalBatteryType</th>
      <td>55.826906</td>
    </tr>
    <tr>
      <th>Census_IsFlightingInternal</th>
      <td>74.104113</td>
    </tr>
    <tr>
      <th>Census_ThresholdOptIn</th>
      <td>44.585629</td>
    </tr>
    <tr>
      <th>Census_IsWIMBootEnabled</th>
      <td>44.455400</td>
    </tr>
  </tbody>
</table>
</div>




```python
missing_percentages[missing_percentages['Missing Percentage'] > 10].plot.bar()
```




    <matplotlib.axes._subplots.AxesSubplot at 0x7f0d32385320>




![png](output_16_1.png)


There is not as much overlap in the missing SmartScreen and remaining missing fields to be useful. 

Of the remaining fields all except OrganizationIdentifier will be dropped.


```python
ss_dropped['OrganizationIdentifier'].value_counts().index.sort_values()
```




    Float64Index([ 1.0,  2.0,  3.0,  4.0,  5.0,  6.0,  7.0,  8.0, 10.0, 11.0, 12.0,
                  14.0, 15.0, 16.0, 18.0, 19.0, 20.0, 21.0, 22.0, 23.0, 25.0, 26.0,
                  27.0, 28.0, 29.0, 30.0, 31.0, 32.0, 33.0, 34.0, 35.0, 36.0, 37.0,
                  39.0, 40.0, 41.0, 42.0, 43.0, 44.0, 45.0, 46.0, 47.0, 48.0, 49.0,
                  50.0, 51.0, 52.0],
                 dtype='float64')



Looking at the values of `OrganizationIdentifier` we can see that there is no 0 assigned, this will be used to indicate that no Organiation was identified. 


```python
# Drop missing SmartScreen from dataset
train_data = train_data.dropna(subset=['SmartScreen'])
```


```python
data_point_list.append(train_data.shape[0] * train_data.shape[1])
```


```python
train_data['OrganizationIdentifier'] = train_data[['OrganizationIdentifier']].fillna(0)
```


```python
missing_percentages = pd.DataFrame(100 - ((train_data.count() / train_data.shape[0]) * 100), columns=['Missing Percentage'])
```


```python
# Drop columns missing more than 10% of their data
train_data = train_data.drop(list(missing_percentages[missing_percentages['Missing Percentage'] > 10].index), axis=1)
```


```python
# Drop rows for columns missing less than 10% of their data
train_data = train_data.dropna()
```


```python
data_point_list.append(train_data.shape[0] * train_data.shape[1])
```


```python
print("Data available for training:", train_data.shape)
```

    Data available for training: (4725660, 76)



```python
# One more check for any missing data
missing_percentages = pd.DataFrame(100 - ((train_data.count() / train_data.shape[0]) * 100), columns=['Missing Percentage'])
```


```python
missing_percentages[missing_percentages['Missing Percentage'] > 0]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Missing Percentage</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>



Missing and NaN values have now been resolved. 


```python
plt.bar(['Loaded', 'SS Dropped', 'Clean'],data_point_list)
```




    <BarContainer object of 3 artists>




![png](output_31_1.png)



```python
for col in train_data:
    print(train_data[col].sample(3))
    print()
```

    1619606    2e7aa474a9348110c61a5b6ee93a2885
    8647935    f8255468f15726a4c4165d812c77a39a
    6471893    b9c0b7867b675c5e1069a39c8bcc3092
    Name: MachineIdentifier, dtype: object
    
    1489102    win8defender
    5300215    win8defender
    844167     win8defender
    Name: ProductName, dtype: object
    
    6035848    1.1.15000.2
    8399036    1.1.15100.1
    8428157    1.1.14800.3
    Name: EngineVersion, dtype: object
    
    6505899    4.18.1807.18075
    4529777    4.18.1807.18075
    1999356       4.13.17134.1
    Name: AppVersion, dtype: object
    
    3511235     1.275.981.0
    6339285    1.273.1504.0
    7145914     1.273.696.0
    Name: AvSigVersion, dtype: object
    
    7088488    0
    3650457    0
    8547822    0
    Name: IsBeta, dtype: int64
    
    6880396    7.0
    5293231    7.0
    897634     7.0
    Name: RtpStateBitfield, dtype: float64
    
    2488716    0
    5936240    0
    8552810    0
    Name: IsSxsPassiveMode, dtype: int64
    
    2199531    53447.0
    566270     53447.0
    1529618    47238.0
    Name: AVProductStatesIdentifier, dtype: float64
    
    2082731    2.0
    6209993    1.0
    532133     2.0
    Name: AVProductsInstalled, dtype: float64
    
    5701532    1.0
    5002796    1.0
    2965507    1.0
    Name: AVProductsEnabled, dtype: float64
    
    2492279    1
    596347     1
    5046673    1
    Name: HasTpm, dtype: int64
    
    2845658     43
    2966611    220
    3421946     93
    Name: CountryIdentifier, dtype: int64
    
    5326199     2020.0
    7388006    74924.0
    6547783    47755.0
    Name: CityIdentifier, dtype: float64
    
    4880652    27.0
    535235      0.0
    5813137    27.0
    Name: OrganizationIdentifier, dtype: float64
    
    8485767     53.0
    4837362    211.0
    7546647    211.0
    Name: GeoNameIdentifier, dtype: float64
    
    4383651     75
    4948439    251
    8119362     75
    Name: LocaleEnglishNameIdentifier, dtype: int64
    
    4051578    windows10
    7019098    windows10
    2393678    windows10
    Name: Platform, dtype: object
    
    2120718    x64
    8872977    x64
    2719475    x64
    Name: Processor, dtype: object
    
    8783567    10.0.0.0
    4528486    10.0.0.0
    2599606    10.0.0.0
    Name: OsVer, dtype: object
    
    8056203    16299
    8367324    17134
    7848350    16299
    Name: OsBuild, dtype: int64
    
    6661841    768
    8042847    768
    6542620    768
    Name: OsSuite, dtype: int64
    
    4975506    rs2
    6230120    rs1
    1861940    rs2
    Name: OsPlatformSubRelease, dtype: object
    
    3680224     17134.1.amd64fre.rs4_release.180410-1804
    4693264       17134.1.x86fre.rs4_release.180410-1804
    4651414    16299.15.amd64fre.rs3_release.170928-1534
    Name: OsBuildLab, dtype: object
    
    5175016    Home
    2736441    Home
    2100953     Pro
    Name: SkuEdition, dtype: object
    
    1189302    1.0
    3943105    1.0
    7084095    1.0
    Name: IsProtected, dtype: float64
    
    2534486    0
    7364017    0
    6612961    0
    Name: AutoSampleOptIn, dtype: int64
    
    6932632    0.0
    1987035    0.0
    3866625    0.0
    Name: SMode, dtype: float64
    
    3581148    137.0
    4171526    137.0
    3789310    137.0
    Name: IeVerIdentifier, dtype: float64
    
    226661     RequireAdmin
    8779675    RequireAdmin
    7631172    ExistsNotSet
    Name: SmartScreen, dtype: object
    
    4567143    1.0
    7011891    1.0
    2651159    1.0
    Name: Firewall, dtype: float64
    
    8824180    1.0
    6950366    1.0
    385005     1.0
    Name: UacLuaenable, dtype: float64
    
    939228     Notebook
    2533635    AllInOne
    7448178    Notebook
    Name: Census_MDC2FormFactor, dtype: object
    
    549513     Windows.Desktop
    6123841    Windows.Desktop
    8513765    Windows.Desktop
    Name: Census_DeviceFamily, dtype: object
    
    794087     2668.0
    8340012     585.0
    3155093    2206.0
    Name: Census_OEMNameIdentifier, dtype: float64
    
    7145116    263704.0
    2520605    235338.0
    5400815    304896.0
    Name: Census_OEMModelIdentifier, dtype: float64
    
    591944     4.0
    5724570    4.0
    8201706    4.0
    Name: Census_ProcessorCoreCount, dtype: float64
    
    2856185    5.0
    2985910    5.0
    7621146    5.0
    Name: Census_ProcessorManufacturerIdentifier, dtype: float64
    
    3517221    3084.0
    3045450    1850.0
    6825090    2697.0
    Name: Census_ProcessorModelIdentifier, dtype: float64
    
    3423097    953869.0
    7357541    610480.0
    2010731    476940.0
    Name: Census_PrimaryDiskTotalCapacity, dtype: float64
    
    5646267    HDD
    8592542    SSD
    1458344    SSD
    Name: Census_PrimaryDiskTypeName, dtype: object
    
    1028850    467421.0
    1488290    460333.0
    7750046    113907.0
    Name: Census_SystemVolumeTotalCapacity, dtype: float64
    
    63950      0
    1010805    0
    6557426    0
    Name: Census_HasOpticalDiskDrive, dtype: int64
    
    1658789    8192.0
    7768606    6144.0
    2600009    4096.0
    Name: Census_TotalPhysicalRAM, dtype: float64
    
    1205082     Notebook
    7497437    MiniTower
    4513271     Notebook
    Name: Census_ChassisTypeName, dtype: object
    
    2207782    21.5
    5368048    21.5
    4435506    15.5
    Name: Census_InternalPrimaryDiagonalDisplaySizeInInches, dtype: float64
    
    7310107    1920.0
    8132816    1366.0
    689391     1366.0
    Name: Census_InternalPrimaryDisplayResolutionHorizontal, dtype: float64
    
    5190800    768.0
    7960217    768.0
    2272371    900.0
    Name: Census_InternalPrimaryDisplayResolutionVertical, dtype: float64
    
    1446881      Slate
    502947      Mobile
    6183480    Desktop
    Name: Census_PowerPlatformRoleName, dtype: object
    
    1384567    0.000000e+00
    659630     4.294967e+09
    1132501    0.000000e+00
    Name: Census_InternalBatteryNumberOfCharges, dtype: float64
    
    1204462    10.0.10586.1176
    4306976     10.0.16299.431
    7980887     10.0.16299.371
    Name: Census_OSVersion, dtype: object
    
    6772256    amd64
    5526618    amd64
    3719965    amd64
    Name: Census_OSArchitecture, dtype: object
    
    7219057    rs3_release_svc_escrow
    8294809               rs3_release
    1744153               rs4_release
    Name: Census_OSBranch, dtype: object
    
    1628728    14393
    8514454    17134
    2986341    17134
    Name: Census_OSBuildNumber, dtype: int64
    
    2195841     611
    4398713     191
    2115445    1206
    Name: Census_OSBuildRevision, dtype: int64
    
    8458443            Core
    6624025            Core
    1142485    Professional
    Name: Census_OSEdition, dtype: object
    
    3806785                   CORE
    4732530    CORE_SINGLELANGUAGE
    8199159    CORE_SINGLELANGUAGE
    Name: Census_OSSkuName, dtype: object
    
    7610093    UUPUpgrade
    3376903        Update
    3605352    UUPUpgrade
    Name: Census_OSInstallTypeName, dtype: object
    
    678667     26.0
    7892290    17.0
    8887473     8.0
    Name: Census_OSInstallLanguageIdentifier, dtype: float64
    
    4701777    158
    5269483     31
    2527051     72
    Name: Census_OSUILocaleIdentifier, dtype: int64
    
    4733344    Notify
    4960313    Notify
    4331339    Notify
    Name: Census_OSWUAutoUpdateOptionsName, dtype: object
    
    5220751    0
    1640248    0
    1453860    0
    Name: Census_IsPortableOperatingSystem, dtype: int64
    
    1859845    IS_GENUINE
    4515803    IS_GENUINE
    4401015    IS_GENUINE
    Name: Census_GenuineStateName, dtype: object
    
    2819934    Retail
    3263717    OEM:DM
    3730394    Retail
    Name: Census_ActivationChannel, dtype: object
    
    4670211    0.0
    5115266    0.0
    7906534    0.0
    Name: Census_IsFlightsDisabled, dtype: float64
    
    3542395    Retail
    87422      Retail
    7179018    Retail
    Name: Census_FlightRing, dtype: object
    
    1776339    355.0
    187485     628.0
    5519188    142.0
    Name: Census_FirmwareManufacturerIdentifier, dtype: float64
    
    7337617    33115.0
    8537990    20050.0
    2185552    64522.0
    Name: Census_FirmwareVersionIdentifier, dtype: float64
    
    447831     1
    8142921    1
    4064900    1
    Name: Census_IsSecureBootEnabled, dtype: int64
    
    8199285    0.0
    7114840    0.0
    7366576    0.0
    Name: Census_IsVirtualDevice, dtype: float64
    
    6762282    0
    4842665    0
    1149785    0
    Name: Census_IsTouchEnabled, dtype: int64
    
    1588949    0
    5729829    0
    5436133    0
    Name: Census_IsPenCapable, dtype: int64
    
    7519172    0.0
    6618734    0.0
    7317135    0.0
    Name: Census_IsAlwaysOnAlwaysConnectedCapable, dtype: float64
    
    7608419    0.0
    4508794    0.0
    8459775    0.0
    Name: Wdft_IsGamer, dtype: float64
    
    3651929     1.0
    8806291    15.0
    4832661    10.0
    Name: Wdft_RegionIdentifier, dtype: float64
    
    6784006    1
    3208950    1
    8473311    0
    Name: HasDetections, dtype: int64
    


A detailed look into the values of each columns reveals that some data needs to be transformed prior to any substitution taking place. 

The data can be broken down into three over arching data types:
    - Object Data
        - This is fields such as `MachineIdentifier` or `CountryIdentifier`. There a number of the `int64` and `float64` fields such as `Census OS_Version` that require casting to the object type for proper identification.
        
    - Numerical
        - These fields are the measured value of a metric, such as `Census_PrimaryDiskTotalCapacity` or `AVProductsInstalled`, these fields are a mi of `int64` and `float64` and do not require casting at this point. 
        
    - Boolean
        - These fields have a binary value to represent `True` or `False`, such as `HasTpm` or `IsProtected`. These fields are `int64` and do not require casting, if they were a true boolean they would be re-cast to the `int64` format however. 

The fields have been placed into lists below to reflect their categories and can be re-cast.


```python
object_list = ['MachineIdentifier',
'OrganizationIdentifier',
'AVProductStatesIdentifier',
'CityIdentifier',
'GeoNameIdentifier',
'IeVerIdentifier',
'Census_OEMNameIdentifier',
'Census_OEMModelIdentifier',
'Census_ProcessorManufacturerIdentifier',
'Census_ProcessorModelIdentifier',
'Census_OSInstallLanguageIdentifier',
'Census_FirmwareManufacturerIdentifier',
'Census_FirmwareVersionIdentifier',
'Wdft_RegionIdentifier',
'CountryIdentifier',
'LocaleEnglishNameIdentifier',
'Census_OSUILocaleIdentifier',
'ProductName',
'EngineVersion',
'AppVersion',
'AvSigVersion',
'Platform',
'Processor',
'OsVer',
'OsPlatformSubRelease',
'OsBuildLab',
'SkuEdition',
'SmartScreen',
'Census_MDC2FormFactor',
'Census_DeviceFamily',
'Census_ChassisTypeName',
'Census_PrimaryDiskTypeName',
'Census_PowerPlatformRoleName',
'Census_OSVersion',
'Census_OSArchitecture',
'Census_OSBranch',
'Census_OSEdition',
'Census_OSSkuName',
'Census_OSInstallTypeName',
'Census_OSWUAutoUpdateOptionsName',
'Census_GenuineStateName',
'Census_ActivationChannel',
'Census_FlightRing',
'Census_OSBuildNumber',
'Census_OSBuildRevision',
'OsSuite',
'RtpStateBitfield',
'UacLuaenable',
'OsBuild']

number_list = ['Census_PrimaryDiskTotalCapacity',
'Census_SystemVolumeTotalCapacity',
'Census_TotalPhysicalRAM',
'Census_InternalPrimaryDiagonalDisplaySizeInInches',
'Census_InternalPrimaryDisplayResolutionHorizontal',
'Census_InternalPrimaryDisplayResolutionVertical',
'Census_InternalBatteryNumberOfCharges',
'AVProductsInstalled',
'AVProductsEnabled',
'Census_ProcessorCoreCount']

bools = ['IsBeta',
'IsSxsPassiveMode',
'HasTpm',
'AutoSampleOptIn',
'Census_HasOpticalDiskDrive',
'Census_IsPortableOperatingSystem',
'Census_IsSecureBootEnabled',
'Census_IsTouchEnabled',
'Census_IsPenCapable',
'HasDetections',
'IsProtected',
'SMode',
'Firewall',
'Census_IsFlightsDisabled',
'Census_IsVirtualDevice',
'Census_IsAlwaysOnAlwaysConnectedCapable',
'Wdft_IsGamer']
```


```python
for obj in object_list:
    train_data[obj] = train_data[obj].astype('object')
```


```python
train_data.dtypes.value_counts().plot.pie()
```




    <matplotlib.axes._subplots.AxesSubplot at 0x7f0c28c94908>




![png](output_36_1.png)


All data has now been sorted into the correct categories, now the object data will be LabelEncoded so that further investigation and modelling can take place. 


```python
transformation_dict = defaultdict(LabelEncoder)

train_data[object_list] = train_data[object_list].apply(lambda x: transformation_dict[x.name].fit_transform(x))
```


```python
def decode(df=train_data, col_list=object_list, transform_dict=transformation_dict):
    transformed_df = df[col_list].apply(lambda x: transform_dict[x.name].inverse_transform(x))
    
    return transformed_df
```

And normalize the number fields


```python
to_be_norm = train_data[number_list]

min_max_scaler = preprocessing.MinMaxScaler()
to_be_norm_scaled = min_max_scaler.fit_transform(to_be_norm)

train_data[number_list] = pd.DataFrame(to_be_norm_scaled)
```

Data is now labelled and scaled, we can now check correlations accross the entire dataset


```python
plt.figure(figsize=(30,30))
sns.heatmap(train_data.corr(), cmap='RdBu_r', center=0.0, annot_kws={"size": 6})
plt.show()
```


![png](output_43_0.png)


The visualization above shows a number of very strong positive and negative correlations, further investigation to check for overlapping and repeated data is warranted. 


```python
corr = pd.DataFrame(train_data.corr().unstack(), columns=['Correlation'])
```


```python
# Postive correlations
corr[corr['Correlation'].between(0.9, 0.9999)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Correlation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>EngineVersion</th>
      <th>AvSigVersion</th>
      <td>0.901399</td>
    </tr>
    <tr>
      <th>AvSigVersion</th>
      <th>EngineVersion</th>
      <td>0.901399</td>
    </tr>
    <tr>
      <th>Platform</th>
      <th>OsVer</th>
      <td>0.999470</td>
    </tr>
    <tr>
      <th>Processor</th>
      <th>Census_OSArchitecture</th>
      <td>0.995984</td>
    </tr>
    <tr>
      <th>OsVer</th>
      <th>Platform</th>
      <td>0.999470</td>
    </tr>
    <tr>
      <th>OsBuildLab</th>
      <th>IeVerIdentifier</th>
      <td>0.951463</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">SkuEdition</th>
      <th>Census_OSEdition</th>
      <td>0.920566</td>
    </tr>
    <tr>
      <th>Census_OSSkuName</th>
      <td>0.906636</td>
    </tr>
    <tr>
      <th>IeVerIdentifier</th>
      <th>OsBuildLab</th>
      <td>0.951463</td>
    </tr>
    <tr>
      <th>Census_OSVersion</th>
      <th>Census_OSBuildNumber</th>
      <td>0.985123</td>
    </tr>
    <tr>
      <th>Census_OSArchitecture</th>
      <th>Processor</th>
      <td>0.995984</td>
    </tr>
    <tr>
      <th>Census_OSBuildNumber</th>
      <th>Census_OSVersion</th>
      <td>0.985123</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Census_OSEdition</th>
      <th>SkuEdition</th>
      <td>0.920566</td>
    </tr>
    <tr>
      <th>Census_OSSkuName</th>
      <td>0.998320</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Census_OSSkuName</th>
      <th>SkuEdition</th>
      <td>0.906636</td>
    </tr>
    <tr>
      <th>Census_OSEdition</th>
      <td>0.998320</td>
    </tr>
    <tr>
      <th>Census_OSInstallLanguageIdentifier</th>
      <th>Census_OSUILocaleIdentifier</th>
      <td>0.990449</td>
    </tr>
    <tr>
      <th>Census_OSUILocaleIdentifier</th>
      <th>Census_OSInstallLanguageIdentifier</th>
      <td>0.990449</td>
    </tr>
  </tbody>
</table>
</div>




```python
def corr_compare(df):
    for col in df:
        print(df[col].value_counts())
```


```python
to_be_dropped = []

corr_compare(decode(train_data, ['EngineVersion', 'AvSigVersion']))
```

    1.1.15100.1    2176694
    1.1.15200.1    2022569
    1.1.15000.2     183602
    1.1.14901.4     150565
    1.1.14800.3      99025
    1.1.14700.5      34491
    1.1.15300.6      17982
    1.1.14600.4       8850
    1.1.14104.0       4590
    1.1.15300.5       3439
    1.1.14500.5       2843
    1.1.14405.2       2604
    1.1.13504.0       1924
    1.1.14306.0       1833
    1.1.14003.0       1202
    1.1.13303.0       1061
    1.1.13407.0       1046
    1.1.15000.1       1030
    1.1.14202.0       1005
    1.1.13804.0        966
    1.1.13903.0        911
    1.1.14700.3        773
    1.1.13601.0        750
    1.1.14901.3        733
    1.1.14700.4        641
    1.1.12902.0        619
    1.1.13701.0        563
    1.1.13103.0        538
    1.1.14800.1        537
    1.1.13704.0        521
    1.1.13202.0        500
    1.1.13000.0        470
    1.1.14305.0        336
    1.1.12805.0        248
    1.1.14303.0         33
    1.1.14201.0         30
    1.1.14500.2         22
    1.1.12400.0         14
    1.1.14102.0         13
    1.1.14103.0         13
    1.1.14002.0         11
    1.1.13902.0         11
    1.1.12603.0          9
    1.1.12804.0          6
    1.1.13803.0          5
    1.1.12706.0          5
    1.1.12101.0          4
    1.1.12505.0          4
    1.1.14001.0          4
    1.1.13406.0          2
    1.1.11903.0          2
    1.1.11701.0          2
    1.1.13802.0          2
    1.1.12002.0          1
    1.1.12205.0          1
    1.1.13301.0          1
    1.1.9700.0           1
    1.1.11804.0          1
    1.1.10401.0          1
    1.1.13102.0          1
    Name: EngineVersion, dtype: int64
    1.273.1420.0    61505
    1.275.727.0     49710
    1.273.371.0     49261
    1.275.1140.0    48748
    1.273.1826.0    47568
    1.275.1244.0    39530
    1.273.810.0     37822
    1.273.1749.0    35731
    1.275.1209.0    31805
    1.273.1379.0    28459
    1.273.1005.0    27434
    1.273.1527.0    26817
    1.273.894.0     25984
    1.273.781.0     25470
    1.273.337.0     23040
    1.273.717.0     21926
    1.273.461.0     21837
    1.273.1167.0    20986
    1.273.950.0     20005
    1.275.948.0     19867
    1.273.1034.0    19309
    1.273.1112.0    18547
    1.273.1795.0    17968
    1.275.1025.0    17913
    1.273.1574.0    17825
    1.275.1293.0    17787
    1.273.1056.0    17533
    1.273.1311.0    17522
    1.275.511.0     17328
    1.273.665.0     17245
                    ...  
    1.229.2032.0        1
    1.233.2797.0        1
    1.243.850.0         1
    1.223.2221.0        1
    1.233.1206.0        1
    1.229.362.0         1
    1.225.2931.0        1
    1.213.1918.0        1
    1.223.2864.0        1
    1.225.1506.0        1
    1.225.2348.0        1
    1.225.2794.0        1
    1.215.3020.0        1
    1.233.332.0         1
    1.261.463.0         1
    1.229.1623.0        1
    1.233.2210.0        1
    1.237.956.0         1
    1.239.377.0         1
    1.243.847.0         1
    1.233.29.0          1
    1.243.302.0         1
    1.229.59.0          1
    1.227.2687.0        1
    1.225.3897.0        1
    1.241.1216.0        1
    1.213.1796.0        1
    1.235.2003.0        1
    1.251.168.0         1
    1.231.1919.0        1
    Name: AvSigVersion, Length: 7309, dtype: int64


Ouput of the `EngineVersion` and `AvSigVersion` shows similar but distinct data. 

After a brief research into the topic it is shown that `EngineVersion` corresponds to the engine running the malware scans while `AvSigVersion` is the database from which malware signatures are pulled. 

Reccommendation is to keep both columns.


```python
corr_compare(decode(train_data, ['Platform', 'OsVer']))
```

    windows10    4633572
    windows8       91900
    windows7         188
    Name: Platform, dtype: int64
    10.0.0.0      4633342
    6.3.0.0         91877
    6.1.1.0           187
    10.0.3.0           90
    10.0.1.0           61
    10.0.2.0           12
    10.0.32.72          9
    6.3.1.0             8
    10.0.5.0            7
    6.3.3.0             7
    10.0.0.112          6
    10.0.16.0           6
    10.0.5.18           6
    10.0.7.0            5
    10.0.8.0            4
    10.0.4.0            4
    10.0.0.3            2
    10.0.16.36          2
    6.3.4.0             2
    10.0.0.1            2
    10.0.1.44           2
    10.0.80.0           2
    6.3.5.0             2
    10.0.6.0            2
    10.0.32.0           1
    10.0.1.144          1
    10.0.0.2            1
    10.0.48.0           1
    6.3.32.72           1
    6.3.16.0            1
    6.3.0.112           1
    6.3.0.2             1
    6.1.0.0             1
    10.0.21.0           1
    10.0.23.0           1
    10.0.19.80          1
    10.0.0.80           1
    Name: OsVer, dtype: int64


Output of `Platform` and `OsVer` show distinct data but futher research shows us repition data. 

`OsVer` contains a more precise OS identifier, down to version, where `Platform` indicates just the OS. 

Reccommnedation is to drop `Platform`.


```python
to_be_dropped.append('Platform')

corr_compare(decode(train_data, ['Processor', 'Census_OSArchitecture']))
```

    x64      4237835
    x86       487819
    arm64          6
    Name: Processor, dtype: int64
    amd64    4237955
    x86       487699
    arm64          6
    Name: Census_OSArchitecture, dtype: int64


There is no different in the values of `Processor` and `Census_OSArchitecture` just a minute count difference. 

Given the census data has been actively collected the reccommendation is to drop `Processor`.


```python
to_be_dropped.append('Processor')

corr_compare(decode(train_data, ['OsBuild', 'Census_OSVersion', 'Census_OSBuildNumber']))
```

    17134    1841259
    16299    1481190
    14393     526492
    15063     290713
    10586     263100
    10240     222567
    9600       91900
    17692       1864
    17738       1243
    17744        825
    17713        527
    17746        423
    17735        413
    17741        326
    17751        324
    17758        309
    17686        299
    17754        268
    17677        196
    17733        194
    17755        192
    7601         187
    17672        179
    17682        123
    17760        107
    17763         90
    17666         78
    17661         62
    18234         30
    17730         24
    17704         22
    18237         22
    17711         19
    17723         18
    17728         12
    17650         10
    18242          8
    17634          7
    17639          6
    17627          6
    17655          6
    18219          4
    18204          3
    17618          2
    17604          2
    17133          2
    17694          1
    17623          1
    17643          1
    17761          1
    18224          1
    18230          1
    7600           1
    Name: OsBuild, dtype: int64
    10.0.17134.228      688262
    10.0.17134.165      494194
    10.0.16299.431      383916
    10.0.16299.371      220899
    10.0.16299.547      204454
    10.0.17134.285      191740
    10.0.14393.2189     187287
    10.0.17134.112      180003
    10.0.10240.17443    173181
    10.0.10586.1176     149138
    10.0.16299.125      127831
    10.0.16299.611      107819
    10.0.16299.492      103323
    10.0.16299.309       98830
    10.0.17134.191       93206
    10.0.16299.192       52734
    10.0.16299.248       49250
    10.0.17134.137       44841
    10.0.17134.167       40925
    10.0.17134.254       37098
    10.0.17134.286       35855
    10.0.17134.48        35663
    10.0.14393.693       34218
    10.0.15063.1206      33752
    10.0.15063.1088      32228
    10.0.14393.2214      30921
    10.0.17134.81        30604
    10.0.15063.1266      28195
    10.0.16299.15        24735
    10.0.15063.786       24315
                         ...  
    10.0.14316.1000          1
    10.0.16199.1000          1
    10.0.14366.0             1
    10.0.14965.1001          1
    10.0.14393.1797          1
    10.0.14291.1001          1
    10.0.15060.0             1
    10.0.16275.1000          1
    10.0.16170.1000          1
    10.0.14257.1000          1
    10.0.18230.1000          1
    10.0.15031.0             1
    6.2.9200.21703           1
    10.0.14393.1670          1
    10.0.16278.1000          1
    10.0.17643.1000          1
    10.0.16299.201           1
    10.0.7601.112            1
    10.0.17761.1             1
    10.0.17083.1000          1
    10.0.16291.0             1
    10.0.10240.16425         1
    10.0.14342.1001          1
    10.0.14946.1000          1
    10.0.15019.1000          1
    10.0.15055.0             1
    10.0.17744.1000          1
    10.0.16193.1001          1
    10.0.18214.1000          1
    10.0.14295.1004          1
    Name: Census_OSVersion, Length: 372, dtype: int64
    17134    1898371
    16299    1450686
    14393     548563
    15063     300119
    10586     295642
    10240     223784
    17692       1813
    17738       1586
    17744        896
    17746        434
    17735        400
    17758        398
    17741        348
    17751        330
    17754        301
    17686        296
    17733        195
    17677        191
    17755        179
    17763        176
    17672        169
    17760        122
    17682        114
    17666         75
    17661         59
    17713         52
    17133         50
    18237         29
    18234         25
    14986         19
              ...   
    14332          1
    14316          1
    14257          1
    17694          1
    16170          1
    14942          1
    16257          1
    17643          1
    17115          1
    17107          1
    17093          1
    17083          1
    17035          1
    17761          1
    16291          1
    16278          1
    16275          1
    16237          1
    14946          1
    16215          1
    16199          1
    16193          1
    15060          1
    15055          1
    15046          1
    15031          1
    15019          1
    18214          1
    14965          1
    7600           1
    Name: Census_OSBuildNumber, Length: 116, dtype: int64


Both `OsBuild` and `Census_OSBuildNumber` are present in `Census_OSVersion`.

Reccommendation is to drop `OSBuild` and `Census_OSBuildNumber`.


```python
to_be_dropped.append('OsBuild')
to_be_dropped.append('Census_OSBuildNumber')

corr_compare(decode(train_data, ['OsBuildLab', 'IeVerIdentifier']))
```

    17134.1.amd64fre.rs4_release.180410-1804                    1707236
    16299.431.amd64fre.rs3_release_svc_escrow.180502-1908        781080
    16299.15.amd64fre.rs3_release.170928-1534                    524553
    15063.0.amd64fre.rs2_release.170317-1834                     260155
    14393.2189.amd64fre.rs1_release.180329-1711                  162191
    16299.15.x86fre.rs3_release.170928-1534                      157883
    10240.17443.amd64fre.th1.170602-2340                         144483
    17134.1.x86fre.rs4_release.180410-1804                       134020
    10586.1176.amd64fre.th2_release_sec.170913-1848              120838
    14393.2189.x86fre.rs1_release.180329-1711                     32228
    15063.0.x86fre.rs2_release.170317-1834                        30558
    10586.1176.x86fre.th2_release_sec.170913-1848                 30023
    9600.19067.amd64fre.winblue_ltsb_escrow.180619-2033           28385
    9600.19101.amd64fre.winblue_ltsb_escrow.180718-1800           28294
    10240.17443.x86fre.th1.170602-2340                            27738
    14393.693.amd64fre.rs1_release.161220-1747                    26281
    14393.2214.amd64fre.rs1_release_1.180402-1758                 24363
    10240.16384.amd64fre.th1.150709-1700                          19310
    14393.0.amd64fre.rs1_release.160715-1616                      19148
    14393.2007.amd64fre.rs1_release.171231-1800                   18457
    14393.1593.amd64fre.rs1_release.170731-1934                   16945
    14393.1944.amd64fre.rs1_release.171129-2100                   15687
    14393.1770.amd64fre.rs1_release.170917-1700                   14870
    14393.1198.amd64fre.rs1_release_sec.170427-1353               13651
    10586.672.amd64fre.th2_release_sec.161024-1825                12953
    14393.447.amd64fre.rs1_release_inmarket.161102-0100           12946
    10586.1106.amd64fre.th2_release.170904-1742                   12757
    14393.1358.amd64fre.rs1_release.170602-2252                   12631
    14393.2068.amd64fre.rs1_release.180209-1727                   12571
    16299.637.amd64fre.rs3_release_svc.180808-1748                12505
                                                                 ...   
    17694.1000.x86fre.rs_prerelease.180612-1636                       1
    17643.1000.amd64fre.rs_prerelease.180405-1509                     1
    10240.16390.x86fre.th1_st1.150714-1601                            1
    7601.19110.x86fre.win7sp1_gdr.151230-0600                         1
    17623.1002.amd64fre.rs_prerelease.180310-1600                     1
    9600.17630.x86fre.winblue_r7.150109-2022                          1
    16299.0.x86fre.rs3_release.170922-1354                            1
    17761.1.amd64fre.rs5_release.180912-1340                          1
    9600.18725.x86fre.winblue_ltsb.170607-0600                        1
    10586.456.x86fre.th2_release.160617-1853                          1
    17744.1000.amd64fre.rs5_release.180817-1423                       1
    10586.456.amd64fre.th2_release.160617-1853                        1
    18237.1000.x86fre.rs_prerelease.180907-1621                       1
    9600.17031.amd64fre.winblue_gdr.140221-1952                       1
    14439.1944.amd64fre.rs1_release.171157-2100                       1
    7600.16792.x86fre.win7_gdr.110408-1633                            1
    10586.11.x86fre.th2_release.151112-1900                           1
    7601.23807.amd64fre.win7sp1_ldr.170512-0600                       1
    7601.17790.x86fre.win7sp1_gdr.120305-1505                         1
    9600.18066.x86fre.winblue_ltsb.150928-1002                        1
    7601.19018.amd64fre.win7sp1_gdr.150928-1507                       1
    10240.16387.x86fre.th1_st1.150711-1429                            1
    7601.24094.x86fre.win7sp1_ldr_escrow.180330-1600                  1
    9600.18202.x86fre.winblue_ltsb.160119-0600                        1
    18234.1000.x86fre.rs_prerelease.180831-1440                       1
    14393.1797.amd64fre.rs1_release_inmarket_aim.171027-1738          1
    7601.23864.amd64fre.win7sp1_ldr.170707-0600                       1
    17650.1001.x86fre.rs_prerelease.180414-2140                       1
    9600.17328.x86fre.winblue_r3.140827-1500                          1
    10240.17446.amd64fre.th1_escrow.170616-1918                       1
    Name: OsBuildLab, Length: 434, dtype: int64
    137.0    1841255
    117.0    1121427
    98.0      284290
    111.0     216571
    108.0     190210
    53.0      172215
    74.0      165616
    135.0     121184
    94.0       95010
    103.0      82740
    333.0      75821
    107.0      72878
    96.0       63991
    76.0       36303
    105.0      27625
    41.0       26890
    114.0      21980
    323.0      13757
    87.0       11905
    73.0        7916
    42.0        7058
    82.0        5266
    85.0        4176
    91.0        4021
    72.0        3787
    92.0        3512
    68.0        3423
    81.0        3305
    86.0        3270
    88.0        3255
              ...   
    140.0          2
    89.0           2
    216.0          1
    321.0          1
    13.0           1
    388.0          1
    383.0          1
    43.0           1
    347.0          1
    345.0          1
    336.0          1
    141.0          1
    146.0          1
    395.0          1
    324.0          1
    54.0           1
    213.0          1
    165.0          1
    320.0          1
    318.0          1
    313.0          1
    312.0          1
    306.0          1
    304.0          1
    303.0          1
    297.0          1
    287.0          1
    184.0          1
    202.0          1
    429.0          1
    Name: IeVerIdentifier, Length: 147, dtype: int64


Data does not appear to be a replication.

Reccommendation to keep both columns.


```python
corr_compare(decode(train_data, ['SkuEdition', 'Census_OSEdition', 'Census_OSSkuName']))
```

    Home               3123051
    Pro                1550842
    Enterprise           26954
    Enterprise LTSB      13666
    Education            10728
    Cloud                  272
    Invalid                147
    Name: SkuEdition, dtype: int64
    Core                           1946421
    Professional                   1499820
    CoreSingleLanguage             1107808
    CoreCountrySpecific              77926
    ProfessionalEducation            30656
    Enterprise                       26900
    EnterpriseS                      12955
    Education                        10755
    ProfessionalN                     9300
    CoreN                             1554
    EnterpriseSN                       721
    Cloud                              422
    EnterpriseN                        235
    EducationN                         131
    ProfessionalEducationN              18
    ProfessionalWorkstation             15
    CloudN                               6
    Home                                 4
    ServerStandard                       3
    ProfessionalWorkstationN             3
    ProfessionalCountrySpecific          2
    ServerDatacenter                     2
    ServerRdsh                           1
    professional                         1
    Pro                                  1
    Name: Census_OSEdition, dtype: int64
    CORE                    1946415
    PROFESSIONAL            1530642
    CORE_SINGLELANGUAGE     1107682
    CORE_COUNTRYSPECIFIC      77871
    ENTERPRISE                26922
    ENTERPRISE_S              12958
    EDUCATION                 10770
    PROFESSIONAL_N             9313
    CORE_N                     1553
    ENTERPRISE_S_N              723
    CLOUD                       407
    ENTERPRISE_N                234
    EDUCATION_N                 128
    PRO_WORKSTATION              15
    UNLICENSED                    7
    CLOUDN                        6
    PRO_WORKSTATION_N             3
    STANDARD_SERVER               3
    DATACENTER_SERVER             2
    PRO_CHINA                     2
    PRO_FOR_EDUCATION             2
    UNDEFINED                     1
    SERVERRDSH                    1
    Name: Census_OSSkuName, dtype: int64


The three fields in this case repeat the same data. 

Reccommendatino is to srop `SkuEdition` and `Census_OSSkuName`


```python
to_be_dropped.append('SkuEdition')
to_be_dropped.append('Census_OSSkuName')

corr_compare(decode(train_data, ['Census_OSUILocaleIdentifier', 'Census_OSInstallLanguageIdentifier']))
```

    31     1716280
    34      595368
    30      284288
    49      250379
    125     231888
    35      193151
    119     177478
    158     175970
    26      131887
    148     111460
    72      106369
    160     102805
    109      84074
    83       67936
    115      62001
    120      59840
    74       44555
    5        43905
    64       39401
    20       35772
    140      28128
    28       27180
    58       24391
    24       19522
    105      17547
    128      15808
    130      12199
    44        9567
    11        9156
    62        8065
            ...   
    9            4
    75           4
    66           3
    142          3
    150          3
    99           3
    21           3
    69           3
    13           3
    139          2
    46           2
    16           1
    143          1
    141          1
    153          1
    147          1
    45           1
    22           1
    25           1
    87           1
    71           1
    113          1
    57           1
    107          1
    52           1
    106          1
    77           1
    41           1
    89           1
    2            1
    Name: Census_OSUILocaleIdentifier, Length: 121, dtype: int64
    8.0     1735246
    9.0      595682
    7.0      285264
    14.0     249580
    29.0     230672
    10.0     186466
    26.0     176883
    37.0     175816
    5.0      132601
    35.0     111270
    18.0     106282
    39.0     102846
    24.0      84150
    20.0      67398
    25.0      62130
    27.0      59661
    19.0      44724
    1.0       43254
    17.0      39125
    3.0       35700
    33.0      28110
    6.0       27036
    15.0      24109
    4.0       19501
    23.0      17548
    30.0      15622
    31.0      11860
    12.0       9578
    2.0        8947
    16.0       7886
    28.0       5622
    36.0       5555
    13.0       4440
    34.0       4039
    21.0       3378
    38.0       2392
    32.0       2213
    22.0       1574
    11.0       1500
    Name: Census_OSInstallLanguageIdentifier, dtype: int64


`Census_OSUILocaleIdentifier` identifies the locale for the OS UI, ie region. 
`Census_OSInstallLanguageIdentifier` indicates the languate at install. 

Both fields can be used to draw the same conlcusion but present separate data. 

The reccommendation is to keep the fields. 


```python
train_data = train_data.drop(to_be_dropped, axis=1)
```

Now to train the model, the steps that will be taken are: 
1. Separate the labels from the data and create the test/train split
2. Create the lightgbm file-type, allows for faster processing
3. Create the model and paramaters
4. Train the model 


```python
x = train_data.drop('HasDetections', axis=1)
y = train_data['HasDetections']
```


```python
X_train, X_test, y_train, y_test = train_test_split(x, y, test_size=0.25, random_state=0)
```


```python
model_data = lgb.Dataset(X_train, label=y_train, free_raw_data=True)
model_data.save_binary('./model_data.bin')
```




    <lightgbm.basic.Dataset at 0x7f05c4023f98>




```python
param = {'learning_rate': 0.2, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 240, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
```


```python
model = lgb.train(param, model_data, 100)
```


```python
y_pred = model.predict(X_test)

for i in range(0,len(y_pred)):
    if y_pred[i]>=.5:
        y_pred[i]=1
    else:  
        y_pred[i]=0
    
accuracy = accuracy_score(y_pred,y_test)

print(accuracy)
```

    0.6816385436108395



```python
train_data = lgb.Dataset(X_train, label=y_train, free_raw_data=True)
train_data.save_binary('./train.bin')
```




    <lightgbm.basic.Dataset at 0x7fe68eb9a048>




```python
#https://lightgbm.readthedocs.io/en/latest/Parameters-Tuning.html
```


```python
params = {}

params['learning_rate'] = [0.1, 0.05]
params['boosting_type'] = ['gbdt']
params['nthread'] = [6]
params['objective'] = ['regression', 'binary']
params['metric'] = ['auc', 'binary_logloss']
params['sub_feature'] = [0.5, 0.8]
params['num_leaves'] = [40, 80]
params['min_data'] = [60, 80]
params['max_depth'] = [25, 50]
params['max_bin'] = [63]
params['device'] = ['gpu']
```


```python
paramaters = [dict(zip(params, v)) for v in product(*params.values())]

paramaters[3]
```




    {'learning_rate': 0.1,
     'boosting_type': 'gbdt',
     'nthread': 6,
     'objective': 'regression',
     'metric': 'auc',
     'sub_feature': 0.5,
     'num_leaves': 40,
     'min_data': 80,
     'max_depth': 50,
     'max_bin': 63,
     'device': 'gpu'}




```python
accuracy_list = []

for param in paramaters:
    
    model = lgb.train(param, train_data, 100)
    #Prediction
    y_pred=model.predict(X_test)
    #convert into binary values
    for i in range(0,len(y_pred)):
        if y_pred[i]>=.5:       # setting threshold to .5
            y_pred[i]=1
        else:  
            y_pred[i]=0
    
    accuracy=accuracy_score(y_pred,y_test)
    print(accuracy)
    print()
    print(param)
    print()
    accuracy_list.append(accuracy)
    
```

    0.6723022815860642
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6723022815860642
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6722049406855338
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6722049406855338
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6759656852164565
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6759656852164565
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6760240897567747
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6760240897567747
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6722057871281472
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6722057871281472
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6722057871281472
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6722066335707605
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6760190111010949
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6760190111010949
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6757447636943834
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6760190111010949
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6723022815860642
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6723022815860642
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6722049406855338
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6722049406855338
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6759656852164565
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6759656852164565
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6760240897567747
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6760240897567747
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6722057871281472
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6722066335707605
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6722057871281472
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6722057871281472
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6760190111010949
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6760190111010949
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6760190111010949
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6760190111010949
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.672094903145804
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.672094903145804
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.672094903145804
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.672094903145804
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6758793480698992
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6758793480698992
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6756364190398801
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6756364190398801
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6721990155872407
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6723522217002493
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6723259819792368
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6723259819792368
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6760477901499473
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6761095804607187
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6761984569351159
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6762103071317023
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.672094903145804
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.672094903145804
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.672094903145804
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.672094903145804
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6758793480698992
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6758878124960322
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6756364190398801
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6756364190398801
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6723522217002493
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6723115924548105
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6723259819792368
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6723259819792368
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6760477901499473
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6761341272965046
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6761984569351159
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6762103071317023
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6672430940863286
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6672430940863286
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6672430940863286
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6672430940863286
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.671570955168167
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.671570955168167
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6715701087255537
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6715701087255537
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6669536107125777
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.666954457155191
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6669527642699644
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6669527642699644
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6708794115530953
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6708794115530953
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6708794115530953
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6708794115530953
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6672430940863286
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6672430940863286
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6672430940863286
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6672430940863286
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6715718016107803
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.671570955168167
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.671570955168167
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6715701087255537
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6669536107125777
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6669536107125777
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6669527642699644
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6669527642699644
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6708794115530953
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6708794115530953
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6708794115530953
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6708794115530953
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6669434534012181
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6669248316637253
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6668452660580745
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6668452660580745
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6710977937473284
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6709936813058917
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6710825577802889
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6710825577802889
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6664305091775541
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6666184194377082
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6666937528302925
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6665024567996851
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6704824299674543
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6708184676849371
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.670641561178756
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6707532916037124
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6668452660580745
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6669231387784986
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6668334158614881
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6669713860074572
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6709936813058917
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6709928348632783
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6709953741911183
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6710825577802889
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6665972583723755
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6665871010610158
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6665354680616041
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6665625542252299
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6707769919968851
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6707041979321406
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6706584900310221
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}
    
    0.6706356360804628
    
    {'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    



```python
score_df = pd.concat([pd.DataFrame(paramaters), pd.DataFrame(accuracy_list, columns=['score'])], axis=1)
```


```python
score_df.sort_values('score', ascending=False)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>boosting_type</th>
      <th>device</th>
      <th>learning_rate</th>
      <th>max_bin</th>
      <th>max_depth</th>
      <th>metric</th>
      <th>min_data</th>
      <th>nthread</th>
      <th>num_leaves</th>
      <th>objective</th>
      <th>sub_feature</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>47</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.676210</td>
    </tr>
    <tr>
      <th>63</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.676210</td>
    </tr>
    <tr>
      <th>62</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.676198</td>
    </tr>
    <tr>
      <th>46</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.676198</td>
    </tr>
    <tr>
      <th>61</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.676134</td>
    </tr>
    <tr>
      <th>45</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.676110</td>
    </tr>
    <tr>
      <th>60</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.676048</td>
    </tr>
    <tr>
      <th>44</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.676048</td>
    </tr>
    <tr>
      <th>7</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.676024</td>
    </tr>
    <tr>
      <th>6</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.676024</td>
    </tr>
    <tr>
      <th>23</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.676024</td>
    </tr>
    <tr>
      <th>22</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.676024</td>
    </tr>
    <tr>
      <th>31</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.676019</td>
    </tr>
    <tr>
      <th>30</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.676019</td>
    </tr>
    <tr>
      <th>12</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.676019</td>
    </tr>
    <tr>
      <th>13</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.676019</td>
    </tr>
    <tr>
      <th>29</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.676019</td>
    </tr>
    <tr>
      <th>15</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.676019</td>
    </tr>
    <tr>
      <th>28</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.676019</td>
    </tr>
    <tr>
      <th>21</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.675966</td>
    </tr>
    <tr>
      <th>20</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.675966</td>
    </tr>
    <tr>
      <th>4</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.675966</td>
    </tr>
    <tr>
      <th>5</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.675966</td>
    </tr>
    <tr>
      <th>53</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.675888</td>
    </tr>
    <tr>
      <th>52</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.675879</td>
    </tr>
    <tr>
      <th>37</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.675879</td>
    </tr>
    <tr>
      <th>36</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.675879</td>
    </tr>
    <tr>
      <th>14</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.675745</td>
    </tr>
    <tr>
      <th>39</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.675636</td>
    </tr>
    <tr>
      <th>38</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.675636</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>65</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.667243</td>
    </tr>
    <tr>
      <th>66</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.667243</td>
    </tr>
    <tr>
      <th>67</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.667243</td>
    </tr>
    <tr>
      <th>81</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.667243</td>
    </tr>
    <tr>
      <th>82</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.667243</td>
    </tr>
    <tr>
      <th>64</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.667243</td>
    </tr>
    <tr>
      <th>115</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.666971</td>
    </tr>
    <tr>
      <th>73</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.666954</td>
    </tr>
    <tr>
      <th>72</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.666954</td>
    </tr>
    <tr>
      <th>88</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.666954</td>
    </tr>
    <tr>
      <th>89</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.666954</td>
    </tr>
    <tr>
      <th>75</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.666953</td>
    </tr>
    <tr>
      <th>74</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.666953</td>
    </tr>
    <tr>
      <th>91</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.666953</td>
    </tr>
    <tr>
      <th>90</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.666953</td>
    </tr>
    <tr>
      <th>96</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.666943</td>
    </tr>
    <tr>
      <th>97</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.666925</td>
    </tr>
    <tr>
      <th>113</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.666923</td>
    </tr>
    <tr>
      <th>112</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.666845</td>
    </tr>
    <tr>
      <th>99</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.666845</td>
    </tr>
    <tr>
      <th>98</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.666845</td>
    </tr>
    <tr>
      <th>114</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.666833</td>
    </tr>
    <tr>
      <th>106</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.666694</td>
    </tr>
    <tr>
      <th>105</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.666618</td>
    </tr>
    <tr>
      <th>120</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.666597</td>
    </tr>
    <tr>
      <th>121</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.666587</td>
    </tr>
    <tr>
      <th>123</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.666563</td>
    </tr>
    <tr>
      <th>122</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.666535</td>
    </tr>
    <tr>
      <th>107</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.666502</td>
    </tr>
    <tr>
      <th>104</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.666431</td>
    </tr>
  </tbody>
</table>
<p>128 rows  12 columns</p>
</div>




```python
sns.heatmap(score_df.corr())
```




    <matplotlib.axes._subplots.AxesSubplot at 0x7fe69c06fac8>




![png](output_77_1.png)



```python
# We can see num_leaves and score had the greatest affect on the score, just these two for the next round with 
# the top metrics results
```


```python
params = {}

params['learning_rate'] = [0.1,0.2,0.3]
params['boosting_type'] = ['gbdt']
params['nthread'] = [6]
params['objective'] = ['binary']
params['metric'] = ['auc']
params['sub_feature'] = [0.8]
params['num_leaves'] = [80, 160, 240]
params['min_data'] = [80]
params['max_depth'] = [50]
params['max_bin'] = [63]
params['device'] = ['gpu']
```


```python
paramaters_2 = [dict(zip(params, v)) for v in product(*params.values())]
```




    9




```python
accuracy_list = []

for param in paramaters_2:
    
    model = lgb.train(param, train_data, 100)
    #Prediction
    y_pred=model.predict(X_test)
    #convert into binary values
    for i in range(0,len(y_pred)):
        if y_pred[i]>=.5:       # setting threshold to .5
            y_pred[i]=1
        else:  
            y_pred[i]=0
    
    accuracy=accuracy_score(y_pred,y_test)
    print(accuracy)
    print()
    print(param)
    print()
    accuracy_list.append(accuracy)
    
```

    0.6762610936885006
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6792244892776882
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 160, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6806651346055366
    
    {'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 240, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6792634256379003
    
    {'learning_rate': 0.2, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6812669553035978
    
    {'learning_rate': 0.2, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 160, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6815640566608685
    
    {'learning_rate': 0.2, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 240, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6796104671093561
    
    {'learning_rate': 0.3, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6812356369269055
    
    {'learning_rate': 0.3, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 160, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6806566701794036
    
    {'learning_rate': 0.3, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 240, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    



```python
# 0.2 learning rate appears best, num leaves may be able to futher, just them for last round
```


```python
params = {}

params['learning_rate'] = [0.2]
params['boosting_type'] = ['gbdt']
params['nthread'] = [6]
params['objective'] = ['binary']
params['metric'] = ['auc']
params['sub_feature'] = [0.8]
params['num_leaves'] = [240, 480, 720]
params['min_data'] = [80]
params['max_depth'] = [50]
params['max_bin'] = [63]
params['device'] = ['gpu']
```


```python
paramaters_3 = [dict(zip(params, v)) for v in product(*params.values())]
```


```python
accuracy_list = []

for param in paramaters_3:
    
    model = lgb.train(param, train_data, 100)
    #Prediction
    y_pred=model.predict(X_test)
    #convert into binary values
    for i in range(0,len(y_pred)):
        if y_pred[i]>=.5:       # setting threshold to .5
            y_pred[i]=1
        else:  
            y_pred[i]=0
    
    accuracy=accuracy_score(y_pred,y_test)
    print(accuracy)
    print()
    print(param)
    print()
    accuracy_list.append(accuracy)
    
```

    0.681581831955748
    
    {'learning_rate': 0.2, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 240, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6820363716390938
    
    {'learning_rate': 0.2, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 480, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    
    0.6819136374601643
    
    {'learning_rate': 0.2, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 720, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
    



```python
# Only a minor improvement by increasing num_leaves, next to see if training numbers help improvae at all
```


```python
num_list = [100, 200, 400, 500]
```


```python
param = {'learning_rate': 0.2, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 240, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
```


```python
accuracy_list = []

for num in num_list:
    
    model = lgb.train(param, train_data, num)
    #Prediction
    y_pred=model.predict(X_test)
    #convert into binary values
    for i in range(0,len(y_pred)):
        if y_pred[i]>=.5:       # setting threshold to .5
            y_pred[i]=1
        else:  
            y_pred[i]=0
    
    accuracy=accuracy_score(y_pred,y_test)
    print(accuracy)
    print()
    print(num)
    print()
    accuracy_list.append(accuracy)
    
```

    0.6816360042829996
    
    100
    
    0.682136251867464
    
    200
    
    0.6816207683159601
    
    400
    
    0.6811586106490946
    
    500
    



```python
model = lgb.train(param, train_data, 200)
#Prediction
y_pred=model.predict(X_test)
#convert into binary values
for i in range(0,len(y_pred)):
    if y_pred[i]>=.5:       # setting threshold to .5
        y_pred[i]=1
    else:  
        y_pred[i]=0
    
accuracy=accuracy_score(y_pred,y_test)
print(accuracy)
```

    0.6823402445372709



```python
pickle.dump(model, open('saved_model.sav', 'wb'))
```
