<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Microsoft Malware Detection Notebook! | Iron Rain Reports</title>
<meta name="generator" content="Jekyll v3.7.4" />
<meta property="og:title" content="Microsoft Malware Detection Notebook!" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Microsoft Malware Detection" />
<meta property="og:description" content="Microsoft Malware Detection" />
<link rel="canonical" href="http://localhost:4000/jekyll/update/2019/03/11/ModelCreation.html" />
<meta property="og:url" content="http://localhost:4000/jekyll/update/2019/03/11/ModelCreation.html" />
<meta property="og:site_name" content="Iron Rain Reports" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-03-11T11:59:13+11:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"http://localhost:4000/jekyll/update/2019/03/11/ModelCreation.html","dateModified":"2019-03-11T11:59:13+11:00","datePublished":"2019-03-11T11:59:13+11:00","headline":"Microsoft Malware Detection Notebook!","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/jekyll/update/2019/03/11/ModelCreation.html"},"description":"Microsoft Malware Detection","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Iron Rain Reports" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Iron Rain Reports</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Microsoft Malware Detection Notebook!</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2019-03-11T11:59:13+11:00" itemprop="datePublished">Mar 11, 2019
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h1 id="microsoft-malware-detection">Microsoft Malware Detection</h1>

<h2 id="project-overview">Project Overview</h2>
<p>Microsoft have engaged with data scientists world-wide to develop a model for the purpose of detecting malware vulnerable computers.</p>

<p>Microsoft have provided a dataset as one arm of a strategy to detect malware vulnerabilities.</p>

<p>This project will use the data provided to predict whether a computer is more or less likely vulnerable to a malware attack.</p>

<p>Microsoft have provided a training dataset which contains the field <code class="highlighter-rouge">HasDetections</code>, this field indicates whether or not a computer has detected malware.</p>

<p>A test dataset to perform predictions upon has also been provided, the model will be run against this dataset to produce predictions for the customer.</p>

<p>The dataset has been provided by Microsoft for use in the following Kaggle competition https://www.kaggle.com/c/microsoft-malware-prediction</p>

<h2 id="problem-statement">Problem Statement</h2>
<p>Billions of computers are vulnerable to a malware attack, this is a preventable problem that this project aims to contribute towards.</p>

<p>Using the provided datasets this project will predict computers that are vulerable to a malware attack and present this data in a format that would allow the vendor or customer to take action in preventing an attack taking place.</p>

<h2 id="metrics">Metrics</h2>

<p>This project will use a supervised model to obtain results, metrics that will be used include but are not limited to:</p>
<ul>
  <li>Confusion Matrix</li>
  <li>Accuracy Score</li>
  <li>Precision Score</li>
  <li>Recall Score</li>
  <li>Specificity</li>
  <li>F1 Score</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">import</span> <span class="nn">lightgbm</span> <span class="k">as</span> <span class="n">lgb</span>

<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">precision_recall_fscore_support</span>

<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Load the training data into a dataframe</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'../dataset/train.csv'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data_point_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">data_point_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">train_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<p>The first steps are to look at the data types contained in our training data and determine the wholeness of our data</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Look at the dtypes </span>
<span class="n">train_data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>float64    36
object     30
int64      17
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">pie</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f0d55bb5c18&gt;
</code></pre></div></div>

<p><img src="../../../../../assets/malware_notebook/output_8_1.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">missing_percentages</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="p">((</span><span class="n">train_data</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">/</span> <span class="n">train_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'Missing Percentage'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Look at the significant missing data</span>
<span class="n">missing_percentages</span><span class="p">[</span><span class="n">missing_percentages</span><span class="p">[</span><span class="s">'Missing Percentage'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">]</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Missing Percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>DefaultBrowsersIdentifier</th>
      <td>95.141637</td>
    </tr>
    <tr>
      <th>OrganizationIdentifier</th>
      <td>30.841487</td>
    </tr>
    <tr>
      <th>PuaMode</th>
      <td>99.974119</td>
    </tr>
    <tr>
      <th>SmartScreen</th>
      <td>35.610795</td>
    </tr>
    <tr>
      <th>Census_ProcessorClass</th>
      <td>99.589407</td>
    </tr>
    <tr>
      <th>Census_InternalBatteryType</th>
      <td>71.046809</td>
    </tr>
    <tr>
      <th>Census_IsFlightingInternal</th>
      <td>83.044030</td>
    </tr>
    <tr>
      <th>Census_ThresholdOptIn</th>
      <td>63.524472</td>
    </tr>
    <tr>
      <th>Census_IsWIMBootEnabled</th>
      <td>63.439038</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="data-types">Data Types</h3>
<p>Looking at the data types there is a breakdown of float64, int64 and object data.
The next step is to inspect the number data and determine if any of them need to be recast as objects.</p>

<h3 id="missing-data">Missing Data</h3>
<p>The view of missing data is only showing columns with more than 1% of missing data, Iâ€™ve deemed less than 10% a trivial loss for this dataset.</p>

<p>The columns with more than a 10% loss need to be inspected to see if they are worth keeping. Before this begins though the fields, <code class="highlighter-rouge">DefaultBrowserIdentifier</code>, <code class="highlighter-rouge">Census_processorClass</code> &amp; <code class="highlighter-rouge">PuaMode</code> can be dropped as there is no sustainable way to keep them.</p>

<h3 id="missing-data-review">Missing Data Review</h3>
<p>To review the columns before deciding to drop them the data descriptor is used:</p>

<ul>
  <li><code class="highlighter-rouge">OrganizationIdentifier</code> - ID for the organization the machine belongs in, organization ID is mapped to both specific companies and broad industries .</li>
  <li><code class="highlighter-rouge">SmartScreen</code> - A cloud-based anti-phishing and anti-malware component.</li>
  <li><code class="highlighter-rouge">Census_InternalBatteryType</code> - Internal battery type</li>
  <li><code class="highlighter-rouge">Census_IsFlightingInternal</code> - Related to OS releases</li>
  <li><code class="highlighter-rouge">Census_ThresholdOptIn</code> - NA</li>
  <li><code class="highlighter-rouge">Census_IsWIMBootEnabled</code> - Allows a Windows image to be compressed, reducing usage space.</li>
</ul>

<p>Several are not described with the data source and required additional investigation, of these fields the most important at a cursory glance is SmartScreen. 
The missing values of SmartScreen will be dropped and missing values checked again.</p>

<p>SmartScreen will not have missing values substituted as it could lead to errors in the results, instead the dataset will be trimmed.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ss_dropped</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s">'SmartScreen'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">missing_percentages</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="p">((</span><span class="n">ss_dropped</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">/</span> <span class="n">ss_dropped</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'Missing Percentage'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">missing_percentages</span><span class="p">[</span><span class="n">missing_percentages</span><span class="p">[</span><span class="s">'Missing Percentage'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">]</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Missing Percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>DefaultBrowsersIdentifier</th>
      <td>95.223947</td>
    </tr>
    <tr>
      <th>OrganizationIdentifier</th>
      <td>31.069661</td>
    </tr>
    <tr>
      <th>PuaMode</th>
      <td>99.974445</td>
    </tr>
    <tr>
      <th>Census_ProcessorClass</th>
      <td>99.471318</td>
    </tr>
    <tr>
      <th>Census_InternalBatteryType</th>
      <td>55.826906</td>
    </tr>
    <tr>
      <th>Census_IsFlightingInternal</th>
      <td>74.104113</td>
    </tr>
    <tr>
      <th>Census_ThresholdOptIn</th>
      <td>44.585629</td>
    </tr>
    <tr>
      <th>Census_IsWIMBootEnabled</th>
      <td>44.455400</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">missing_percentages</span><span class="p">[</span><span class="n">missing_percentages</span><span class="p">[</span><span class="s">'Missing Percentage'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f0d32385320&gt;
</code></pre></div></div>

<p><img src="../../../../../assets/malware_notebook/output_16_1.png" alt="png" /></p>

<p>There is not as much overlap in the missing SmartScreen and remaining missing fields to be useful.</p>

<p>Of the remaining fields all except OrganizationIdentifier will be dropped.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ss_dropped</span><span class="p">[</span><span class="s">'OrganizationIdentifier'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Float64Index([ 1.0,  2.0,  3.0,  4.0,  5.0,  6.0,  7.0,  8.0, 10.0, 11.0, 12.0,
              14.0, 15.0, 16.0, 18.0, 19.0, 20.0, 21.0, 22.0, 23.0, 25.0, 26.0,
              27.0, 28.0, 29.0, 30.0, 31.0, 32.0, 33.0, 34.0, 35.0, 36.0, 37.0,
              39.0, 40.0, 41.0, 42.0, 43.0, 44.0, 45.0, 46.0, 47.0, 48.0, 49.0,
              50.0, 51.0, 52.0],
             dtype='float64')
</code></pre></div></div>

<p>Looking at the values of <code class="highlighter-rouge">OrganizationIdentifier</code> we can see that there is no 0 assigned, this will be used to indicate that no Organiation was identified.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Drop missing SmartScreen from dataset</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s">'SmartScreen'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data_point_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">train_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_data</span><span class="p">[</span><span class="s">'OrganizationIdentifier'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[[</span><span class="s">'OrganizationIdentifier'</span><span class="p">]]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">missing_percentages</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="p">((</span><span class="n">train_data</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">/</span> <span class="n">train_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'Missing Percentage'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Drop columns missing more than 10% of their data</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">missing_percentages</span><span class="p">[</span><span class="n">missing_percentages</span><span class="p">[</span><span class="s">'Missing Percentage'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Drop rows for columns missing less than 10% of their data</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data_point_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">train_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"Data available for training:"</span><span class="p">,</span> <span class="n">train_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Data available for training: (4725660, 76)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># One more check for any missing data</span>
<span class="n">missing_percentages</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="p">((</span><span class="n">train_data</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">/</span> <span class="n">train_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'Missing Percentage'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">missing_percentages</span><span class="p">[</span><span class="n">missing_percentages</span><span class="p">[</span><span class="s">'Missing Percentage'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Missing Percentage</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>

<p>Missing and NaN values have now been resolved.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s">'Loaded'</span><span class="p">,</span> <span class="s">'SS Dropped'</span><span class="p">,</span> <span class="s">'Clean'</span><span class="p">],</span><span class="n">data_point_list</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;BarContainer object of 3 artists&gt;
</code></pre></div></div>

<p><img src="../../../../../assets/malware_notebook/output_31_1.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">train_data</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="k">print</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1619606    2e7aa474a9348110c61a5b6ee93a2885
8647935    f8255468f15726a4c4165d812c77a39a
6471893    b9c0b7867b675c5e1069a39c8bcc3092
Name: MachineIdentifier, dtype: object

1489102    win8defender
5300215    win8defender
844167     win8defender
Name: ProductName, dtype: object

6035848    1.1.15000.2
8399036    1.1.15100.1
8428157    1.1.14800.3
Name: EngineVersion, dtype: object

6505899    4.18.1807.18075
4529777    4.18.1807.18075
1999356       4.13.17134.1
Name: AppVersion, dtype: object

3511235     1.275.981.0
6339285    1.273.1504.0
7145914     1.273.696.0
Name: AvSigVersion, dtype: object

7088488    0
3650457    0
8547822    0
Name: IsBeta, dtype: int64

6880396    7.0
5293231    7.0
897634     7.0
Name: RtpStateBitfield, dtype: float64

2488716    0
5936240    0
8552810    0
Name: IsSxsPassiveMode, dtype: int64

2199531    53447.0
566270     53447.0
1529618    47238.0
Name: AVProductStatesIdentifier, dtype: float64

2082731    2.0
6209993    1.0
532133     2.0
Name: AVProductsInstalled, dtype: float64

5701532    1.0
5002796    1.0
2965507    1.0
Name: AVProductsEnabled, dtype: float64

2492279    1
596347     1
5046673    1
Name: HasTpm, dtype: int64

2845658     43
2966611    220
3421946     93
Name: CountryIdentifier, dtype: int64

5326199     2020.0
7388006    74924.0
6547783    47755.0
Name: CityIdentifier, dtype: float64

4880652    27.0
535235      0.0
5813137    27.0
Name: OrganizationIdentifier, dtype: float64

8485767     53.0
4837362    211.0
7546647    211.0
Name: GeoNameIdentifier, dtype: float64

4383651     75
4948439    251
8119362     75
Name: LocaleEnglishNameIdentifier, dtype: int64

4051578    windows10
7019098    windows10
2393678    windows10
Name: Platform, dtype: object

2120718    x64
8872977    x64
2719475    x64
Name: Processor, dtype: object

8783567    10.0.0.0
4528486    10.0.0.0
2599606    10.0.0.0
Name: OsVer, dtype: object

8056203    16299
8367324    17134
7848350    16299
Name: OsBuild, dtype: int64

6661841    768
8042847    768
6542620    768
Name: OsSuite, dtype: int64

4975506    rs2
6230120    rs1
1861940    rs2
Name: OsPlatformSubRelease, dtype: object

3680224     17134.1.amd64fre.rs4_release.180410-1804
4693264       17134.1.x86fre.rs4_release.180410-1804
4651414    16299.15.amd64fre.rs3_release.170928-1534
Name: OsBuildLab, dtype: object

5175016    Home
2736441    Home
2100953     Pro
Name: SkuEdition, dtype: object

1189302    1.0
3943105    1.0
7084095    1.0
Name: IsProtected, dtype: float64

2534486    0
7364017    0
6612961    0
Name: AutoSampleOptIn, dtype: int64

6932632    0.0
1987035    0.0
3866625    0.0
Name: SMode, dtype: float64

3581148    137.0
4171526    137.0
3789310    137.0
Name: IeVerIdentifier, dtype: float64

226661     RequireAdmin
8779675    RequireAdmin
7631172    ExistsNotSet
Name: SmartScreen, dtype: object

4567143    1.0
7011891    1.0
2651159    1.0
Name: Firewall, dtype: float64

8824180    1.0
6950366    1.0
385005     1.0
Name: UacLuaenable, dtype: float64

939228     Notebook
2533635    AllInOne
7448178    Notebook
Name: Census_MDC2FormFactor, dtype: object

549513     Windows.Desktop
6123841    Windows.Desktop
8513765    Windows.Desktop
Name: Census_DeviceFamily, dtype: object

794087     2668.0
8340012     585.0
3155093    2206.0
Name: Census_OEMNameIdentifier, dtype: float64

7145116    263704.0
2520605    235338.0
5400815    304896.0
Name: Census_OEMModelIdentifier, dtype: float64

591944     4.0
5724570    4.0
8201706    4.0
Name: Census_ProcessorCoreCount, dtype: float64

2856185    5.0
2985910    5.0
7621146    5.0
Name: Census_ProcessorManufacturerIdentifier, dtype: float64

3517221    3084.0
3045450    1850.0
6825090    2697.0
Name: Census_ProcessorModelIdentifier, dtype: float64

3423097    953869.0
7357541    610480.0
2010731    476940.0
Name: Census_PrimaryDiskTotalCapacity, dtype: float64

5646267    HDD
8592542    SSD
1458344    SSD
Name: Census_PrimaryDiskTypeName, dtype: object

1028850    467421.0
1488290    460333.0
7750046    113907.0
Name: Census_SystemVolumeTotalCapacity, dtype: float64

63950      0
1010805    0
6557426    0
Name: Census_HasOpticalDiskDrive, dtype: int64

1658789    8192.0
7768606    6144.0
2600009    4096.0
Name: Census_TotalPhysicalRAM, dtype: float64

1205082     Notebook
7497437    MiniTower
4513271     Notebook
Name: Census_ChassisTypeName, dtype: object

2207782    21.5
5368048    21.5
4435506    15.5
Name: Census_InternalPrimaryDiagonalDisplaySizeInInches, dtype: float64

7310107    1920.0
8132816    1366.0
689391     1366.0
Name: Census_InternalPrimaryDisplayResolutionHorizontal, dtype: float64

5190800    768.0
7960217    768.0
2272371    900.0
Name: Census_InternalPrimaryDisplayResolutionVertical, dtype: float64

1446881      Slate
502947      Mobile
6183480    Desktop
Name: Census_PowerPlatformRoleName, dtype: object

1384567    0.000000e+00
659630     4.294967e+09
1132501    0.000000e+00
Name: Census_InternalBatteryNumberOfCharges, dtype: float64

1204462    10.0.10586.1176
4306976     10.0.16299.431
7980887     10.0.16299.371
Name: Census_OSVersion, dtype: object

6772256    amd64
5526618    amd64
3719965    amd64
Name: Census_OSArchitecture, dtype: object

7219057    rs3_release_svc_escrow
8294809               rs3_release
1744153               rs4_release
Name: Census_OSBranch, dtype: object

1628728    14393
8514454    17134
2986341    17134
Name: Census_OSBuildNumber, dtype: int64

2195841     611
4398713     191
2115445    1206
Name: Census_OSBuildRevision, dtype: int64

8458443            Core
6624025            Core
1142485    Professional
Name: Census_OSEdition, dtype: object

3806785                   CORE
4732530    CORE_SINGLELANGUAGE
8199159    CORE_SINGLELANGUAGE
Name: Census_OSSkuName, dtype: object

7610093    UUPUpgrade
3376903        Update
3605352    UUPUpgrade
Name: Census_OSInstallTypeName, dtype: object

678667     26.0
7892290    17.0
8887473     8.0
Name: Census_OSInstallLanguageIdentifier, dtype: float64

4701777    158
5269483     31
2527051     72
Name: Census_OSUILocaleIdentifier, dtype: int64

4733344    Notify
4960313    Notify
4331339    Notify
Name: Census_OSWUAutoUpdateOptionsName, dtype: object

5220751    0
1640248    0
1453860    0
Name: Census_IsPortableOperatingSystem, dtype: int64

1859845    IS_GENUINE
4515803    IS_GENUINE
4401015    IS_GENUINE
Name: Census_GenuineStateName, dtype: object

2819934    Retail
3263717    OEM:DM
3730394    Retail
Name: Census_ActivationChannel, dtype: object

4670211    0.0
5115266    0.0
7906534    0.0
Name: Census_IsFlightsDisabled, dtype: float64

3542395    Retail
87422      Retail
7179018    Retail
Name: Census_FlightRing, dtype: object

1776339    355.0
187485     628.0
5519188    142.0
Name: Census_FirmwareManufacturerIdentifier, dtype: float64

7337617    33115.0
8537990    20050.0
2185552    64522.0
Name: Census_FirmwareVersionIdentifier, dtype: float64

447831     1
8142921    1
4064900    1
Name: Census_IsSecureBootEnabled, dtype: int64

8199285    0.0
7114840    0.0
7366576    0.0
Name: Census_IsVirtualDevice, dtype: float64

6762282    0
4842665    0
1149785    0
Name: Census_IsTouchEnabled, dtype: int64

1588949    0
5729829    0
5436133    0
Name: Census_IsPenCapable, dtype: int64

7519172    0.0
6618734    0.0
7317135    0.0
Name: Census_IsAlwaysOnAlwaysConnectedCapable, dtype: float64

7608419    0.0
4508794    0.0
8459775    0.0
Name: Wdft_IsGamer, dtype: float64

3651929     1.0
8806291    15.0
4832661    10.0
Name: Wdft_RegionIdentifier, dtype: float64

6784006    1
3208950    1
8473311    0
Name: HasDetections, dtype: int64
</code></pre></div></div>

<p>A detailed look into the values of each columns reveals that some data needs to be transformed prior to any substitution taking place.</p>

<p>The data can be broken down into three over arching data types:
    - Object Data
        - This is fields such as <code class="highlighter-rouge">MachineIdentifier</code> or <code class="highlighter-rouge">CountryIdentifier</code>. There a number of the <code class="highlighter-rouge">int64</code> and <code class="highlighter-rouge">float64</code> fields such as <code class="highlighter-rouge">Census OS_Version</code> that require casting to the object type for proper identification.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- Numerical
    - These fields are the measured value of a metric, such as `Census_PrimaryDiskTotalCapacity` or `AVProductsInstalled`, these fields are a mi of `int64` and `float64` and do not require casting at this point. 
    
- Boolean
    - These fields have a binary value to represent `True` or `False`, such as `HasTpm` or `IsProtected`. These fields are `int64` and do not require casting, if they were a true boolean they would be re-cast to the `int64` format however. 
</code></pre></div></div>

<p>The fields have been placed into lists below to reflect their categories and can be re-cast.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">object_list</span> <span class="o">=</span> <span class="p">[</span><span class="s">'MachineIdentifier'</span><span class="p">,</span>
<span class="s">'OrganizationIdentifier'</span><span class="p">,</span>
<span class="s">'AVProductStatesIdentifier'</span><span class="p">,</span>
<span class="s">'CityIdentifier'</span><span class="p">,</span>
<span class="s">'GeoNameIdentifier'</span><span class="p">,</span>
<span class="s">'IeVerIdentifier'</span><span class="p">,</span>
<span class="s">'Census_OEMNameIdentifier'</span><span class="p">,</span>
<span class="s">'Census_OEMModelIdentifier'</span><span class="p">,</span>
<span class="s">'Census_ProcessorManufacturerIdentifier'</span><span class="p">,</span>
<span class="s">'Census_ProcessorModelIdentifier'</span><span class="p">,</span>
<span class="s">'Census_OSInstallLanguageIdentifier'</span><span class="p">,</span>
<span class="s">'Census_FirmwareManufacturerIdentifier'</span><span class="p">,</span>
<span class="s">'Census_FirmwareVersionIdentifier'</span><span class="p">,</span>
<span class="s">'Wdft_RegionIdentifier'</span><span class="p">,</span>
<span class="s">'CountryIdentifier'</span><span class="p">,</span>
<span class="s">'LocaleEnglishNameIdentifier'</span><span class="p">,</span>
<span class="s">'Census_OSUILocaleIdentifier'</span><span class="p">,</span>
<span class="s">'ProductName'</span><span class="p">,</span>
<span class="s">'EngineVersion'</span><span class="p">,</span>
<span class="s">'AppVersion'</span><span class="p">,</span>
<span class="s">'AvSigVersion'</span><span class="p">,</span>
<span class="s">'Platform'</span><span class="p">,</span>
<span class="s">'Processor'</span><span class="p">,</span>
<span class="s">'OsVer'</span><span class="p">,</span>
<span class="s">'OsPlatformSubRelease'</span><span class="p">,</span>
<span class="s">'OsBuildLab'</span><span class="p">,</span>
<span class="s">'SkuEdition'</span><span class="p">,</span>
<span class="s">'SmartScreen'</span><span class="p">,</span>
<span class="s">'Census_MDC2FormFactor'</span><span class="p">,</span>
<span class="s">'Census_DeviceFamily'</span><span class="p">,</span>
<span class="s">'Census_ChassisTypeName'</span><span class="p">,</span>
<span class="s">'Census_PrimaryDiskTypeName'</span><span class="p">,</span>
<span class="s">'Census_PowerPlatformRoleName'</span><span class="p">,</span>
<span class="s">'Census_OSVersion'</span><span class="p">,</span>
<span class="s">'Census_OSArchitecture'</span><span class="p">,</span>
<span class="s">'Census_OSBranch'</span><span class="p">,</span>
<span class="s">'Census_OSEdition'</span><span class="p">,</span>
<span class="s">'Census_OSSkuName'</span><span class="p">,</span>
<span class="s">'Census_OSInstallTypeName'</span><span class="p">,</span>
<span class="s">'Census_OSWUAutoUpdateOptionsName'</span><span class="p">,</span>
<span class="s">'Census_GenuineStateName'</span><span class="p">,</span>
<span class="s">'Census_ActivationChannel'</span><span class="p">,</span>
<span class="s">'Census_FlightRing'</span><span class="p">,</span>
<span class="s">'Census_OSBuildNumber'</span><span class="p">,</span>
<span class="s">'Census_OSBuildRevision'</span><span class="p">,</span>
<span class="s">'OsSuite'</span><span class="p">,</span>
<span class="s">'RtpStateBitfield'</span><span class="p">,</span>
<span class="s">'UacLuaenable'</span><span class="p">,</span>
<span class="s">'OsBuild'</span><span class="p">]</span>

<span class="n">number_list</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Census_PrimaryDiskTotalCapacity'</span><span class="p">,</span>
<span class="s">'Census_SystemVolumeTotalCapacity'</span><span class="p">,</span>
<span class="s">'Census_TotalPhysicalRAM'</span><span class="p">,</span>
<span class="s">'Census_InternalPrimaryDiagonalDisplaySizeInInches'</span><span class="p">,</span>
<span class="s">'Census_InternalPrimaryDisplayResolutionHorizontal'</span><span class="p">,</span>
<span class="s">'Census_InternalPrimaryDisplayResolutionVertical'</span><span class="p">,</span>
<span class="s">'Census_InternalBatteryNumberOfCharges'</span><span class="p">,</span>
<span class="s">'AVProductsInstalled'</span><span class="p">,</span>
<span class="s">'AVProductsEnabled'</span><span class="p">,</span>
<span class="s">'Census_ProcessorCoreCount'</span><span class="p">]</span>

<span class="n">bools</span> <span class="o">=</span> <span class="p">[</span><span class="s">'IsBeta'</span><span class="p">,</span>
<span class="s">'IsSxsPassiveMode'</span><span class="p">,</span>
<span class="s">'HasTpm'</span><span class="p">,</span>
<span class="s">'AutoSampleOptIn'</span><span class="p">,</span>
<span class="s">'Census_HasOpticalDiskDrive'</span><span class="p">,</span>
<span class="s">'Census_IsPortableOperatingSystem'</span><span class="p">,</span>
<span class="s">'Census_IsSecureBootEnabled'</span><span class="p">,</span>
<span class="s">'Census_IsTouchEnabled'</span><span class="p">,</span>
<span class="s">'Census_IsPenCapable'</span><span class="p">,</span>
<span class="s">'HasDetections'</span><span class="p">,</span>
<span class="s">'IsProtected'</span><span class="p">,</span>
<span class="s">'SMode'</span><span class="p">,</span>
<span class="s">'Firewall'</span><span class="p">,</span>
<span class="s">'Census_IsFlightsDisabled'</span><span class="p">,</span>
<span class="s">'Census_IsVirtualDevice'</span><span class="p">,</span>
<span class="s">'Census_IsAlwaysOnAlwaysConnectedCapable'</span><span class="p">,</span>
<span class="s">'Wdft_IsGamer'</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">object_list</span><span class="p">:</span>
    <span class="n">train_data</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">'object'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">pie</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f0c28c94908&gt;
</code></pre></div></div>

<p><img src="../../../../../assets/malware_notebook/output_36_1.png" alt="png" /></p>

<p>All data has now been sorted into the correct categories, now the object data will be LabelEncoded so that further investigation and modelling can take place.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">transformation_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">LabelEncoder</span><span class="p">)</span>

<span class="n">train_data</span><span class="p">[</span><span class="n">object_list</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="n">object_list</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> \ 
                                                        <span class="n">transformation_dict</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span> <span class="n">col_list</span><span class="o">=</span><span class="n">object_list</span><span class="p">,</span> <span class="n">transform_dict</span><span class="o">=</span><span class="n">transformation_dict</span><span class="p">):</span>
    <span class="n">transformed_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col_list</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">transform_dict</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">transformed_df</span>
</code></pre></div></div>

<p>And normalize the number fields</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">to_be_norm</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="n">number_list</span><span class="p">]</span>

<span class="n">min_max_scaler</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">to_be_norm_scaled</span> <span class="o">=</span> <span class="n">min_max_scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">to_be_norm</span><span class="p">)</span>

<span class="n">train_data</span><span class="p">[</span><span class="n">number_list</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">to_be_norm_scaled</span><span class="p">)</span>
</code></pre></div></div>

<p>Data is now labelled and scaled, we can now check correlations accross the entire dataset</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">train_data</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'RdBu_r'</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s">"size"</span><span class="p">:</span> <span class="mi">6</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="../../../../../assets/malware_notebook/output_43_0.png" alt="png" /></p>

<p>The visualization above shows a number of very strong positive and negative correlations, further investigation to check for overlapping and repeated data is warranted.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">corr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_data</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'Correlation'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Postive correlations</span>
<span class="n">corr</span><span class="p">[</span><span class="n">corr</span><span class="p">[</span><span class="s">'Correlation'</span><span class="p">]</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9999</span><span class="p">)]</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Correlation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>EngineVersion</th>
      <th>AvSigVersion</th>
      <td>0.901399</td>
    </tr>
    <tr>
      <th>AvSigVersion</th>
      <th>EngineVersion</th>
      <td>0.901399</td>
    </tr>
    <tr>
      <th>Platform</th>
      <th>OsVer</th>
      <td>0.999470</td>
    </tr>
    <tr>
      <th>Processor</th>
      <th>Census_OSArchitecture</th>
      <td>0.995984</td>
    </tr>
    <tr>
      <th>OsVer</th>
      <th>Platform</th>
      <td>0.999470</td>
    </tr>
    <tr>
      <th>OsBuildLab</th>
      <th>IeVerIdentifier</th>
      <td>0.951463</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">SkuEdition</th>
      <th>Census_OSEdition</th>
      <td>0.920566</td>
    </tr>
    <tr>
      <th>Census_OSSkuName</th>
      <td>0.906636</td>
    </tr>
    <tr>
      <th>IeVerIdentifier</th>
      <th>OsBuildLab</th>
      <td>0.951463</td>
    </tr>
    <tr>
      <th>Census_OSVersion</th>
      <th>Census_OSBuildNumber</th>
      <td>0.985123</td>
    </tr>
    <tr>
      <th>Census_OSArchitecture</th>
      <th>Processor</th>
      <td>0.995984</td>
    </tr>
    <tr>
      <th>Census_OSBuildNumber</th>
      <th>Census_OSVersion</th>
      <td>0.985123</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Census_OSEdition</th>
      <th>SkuEdition</th>
      <td>0.920566</td>
    </tr>
    <tr>
      <th>Census_OSSkuName</th>
      <td>0.998320</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Census_OSSkuName</th>
      <th>SkuEdition</th>
      <td>0.906636</td>
    </tr>
    <tr>
      <th>Census_OSEdition</th>
      <td>0.998320</td>
    </tr>
    <tr>
      <th>Census_OSInstallLanguageIdentifier</th>
      <th>Census_OSUILocaleIdentifier</th>
      <td>0.990449</td>
    </tr>
    <tr>
      <th>Census_OSUILocaleIdentifier</th>
      <th>Census_OSInstallLanguageIdentifier</th>
      <td>0.990449</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">corr_compare</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">to_be_dropped</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">corr_compare</span><span class="p">(</span><span class="n">decode</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="p">[</span><span class="s">'EngineVersion'</span><span class="p">,</span> <span class="s">'AvSigVersion'</span><span class="p">]))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1.1.15100.1    2176694
1.1.15200.1    2022569
1.1.15000.2     183602
1.1.14901.4     150565
1.1.14800.3      99025
1.1.14700.5      34491
1.1.15300.6      17982
1.1.14600.4       8850
1.1.14104.0       4590
1.1.15300.5       3439
1.1.14500.5       2843
1.1.14405.2       2604
1.1.13504.0       1924
1.1.14306.0       1833
1.1.14003.0       1202
1.1.13303.0       1061
1.1.13407.0       1046
1.1.15000.1       1030
1.1.14202.0       1005
1.1.13804.0        966
1.1.13903.0        911
1.1.14700.3        773
1.1.13601.0        750
1.1.14901.3        733
1.1.14700.4        641
1.1.12902.0        619
1.1.13701.0        563
1.1.13103.0        538
1.1.14800.1        537
1.1.13704.0        521
1.1.13202.0        500
1.1.13000.0        470
1.1.14305.0        336
1.1.12805.0        248
1.1.14303.0         33
1.1.14201.0         30
1.1.14500.2         22
1.1.12400.0         14
1.1.14102.0         13
1.1.14103.0         13
1.1.13902.0         11
1.1.14002.0         11
1.1.12603.0          9
1.1.12804.0          6
1.1.12706.0          5
1.1.13803.0          5
1.1.12505.0          4
1.1.12101.0          4
1.1.14001.0          4
1.1.11701.0          2
1.1.11903.0          2
1.1.13406.0          2
1.1.13802.0          2
1.1.11804.0          1
1.1.12205.0          1
1.1.13102.0          1
1.1.13301.0          1
1.1.9700.0           1
1.1.12002.0          1
1.1.10401.0          1
Name: EngineVersion, dtype: int64
1.273.1420.0    61505
1.275.727.0     49710
1.273.371.0     49261
1.275.1140.0    48748
1.273.1826.0    47568
1.275.1244.0    39530
1.273.810.0     37822
1.273.1749.0    35731
1.275.1209.0    31805
1.273.1379.0    28459
1.273.1005.0    27434
1.273.1527.0    26817
1.273.894.0     25984
1.273.781.0     25470
1.273.337.0     23040
1.273.717.0     21926
1.273.461.0     21837
1.273.1167.0    20986
1.273.950.0     20005
1.275.948.0     19867
1.273.1034.0    19309
1.273.1112.0    18547
1.273.1795.0    17968
1.275.1025.0    17913
1.273.1574.0    17825
1.275.1293.0    17787
1.273.1056.0    17533
1.273.1311.0    17522
1.275.511.0     17328
1.273.665.0     17245
                ...  
1.239.1445.0        1
1.225.618.0         1
1.227.2687.0        1
1.229.754.0         1
1.231.1128.0        1
1.257.1094.0        1
1.231.903.0         1
1.257.1169.0        1
1.227.2289.0        1
1.223.2098.0        1
1.245.40.0          1
1.231.848.0         1
1.233.3562.0        1
1.251.958.0         1
1.231.1926.0        1
1.225.3072.0        1
1.245.1003.0        1
1.229.2009.0        1
1.261.1581.0        1
1.235.447.0         1
1.237.409.0         1
1.223.2694.0        1
1.225.2323.0        1
1.263.142.0         1
1.245.530.0         1
1.239.300.0         1
1.233.2797.0        1
1.225.387.0         1
1.263.183.0         1
1.225.4084.0        1
Name: AvSigVersion, Length: 7309, dtype: int64
</code></pre></div></div>

<p>Ouput of the <code class="highlighter-rouge">EngineVersion</code> and <code class="highlighter-rouge">AvSigVersion</code> shows similar but distinct data.</p>

<p>After a brief research into the topic it is shown that <code class="highlighter-rouge">EngineVersion</code> corresponds to the engine running the malware scans while <code class="highlighter-rouge">AvSigVersion</code> is the database from which malware signatures are pulled.</p>

<p>Reccommendation is to keep both columns.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">corr_compare</span><span class="p">(</span><span class="n">decode</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="p">[</span><span class="s">'Platform'</span><span class="p">,</span> <span class="s">'OsVer'</span><span class="p">]))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>windows10    4633572
windows8       91900
windows7         188
Name: Platform, dtype: int64
10.0.0.0      4633342
6.3.0.0         91877
6.1.1.0           187
10.0.3.0           90
10.0.1.0           61
10.0.2.0           12
10.0.32.72          9
6.3.1.0             8
6.3.3.0             7
10.0.5.0            7
10.0.0.112          6
10.0.16.0           6
10.0.5.18           6
10.0.7.0            5
10.0.8.0            4
10.0.4.0            4
10.0.0.3            2
10.0.16.36          2
10.0.1.44           2
6.3.4.0             2
6.3.5.0             2
10.0.0.1            2
10.0.6.0            2
10.0.80.0           2
6.3.0.2             1
10.0.32.0           1
10.0.0.2            1
10.0.0.80           1
10.0.19.80          1
10.0.21.0           1
6.1.0.0             1
10.0.23.0           1
6.3.16.0            1
6.3.0.112           1
10.0.48.0           1
6.3.32.72           1
10.0.1.144          1
Name: OsVer, dtype: int64
</code></pre></div></div>

<p>Output of <code class="highlighter-rouge">Platform</code> and <code class="highlighter-rouge">OsVer</code> show distinct data but futher research shows us repition data.</p>

<p><code class="highlighter-rouge">OsVer</code> contains a more precise OS identifier, down to version, where <code class="highlighter-rouge">Platform</code> indicates just the OS.</p>

<p>Reccommnedation is to drop <code class="highlighter-rouge">Platform</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">to_be_dropped</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'Platform'</span><span class="p">)</span>

<span class="n">corr_compare</span><span class="p">(</span><span class="n">decode</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="p">[</span><span class="s">'Processor'</span><span class="p">,</span> <span class="s">'Census_OSArchitecture'</span><span class="p">]))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>x64      4237835
x86       487819
arm64          6
Name: Processor, dtype: int64
amd64    4237955
x86       487699
arm64          6
Name: Census_OSArchitecture, dtype: int64
</code></pre></div></div>

<p>There is no different in the values of <code class="highlighter-rouge">Processor</code> and <code class="highlighter-rouge">Census_OSArchitecture</code> just a minute count difference.</p>

<p>Given the census data has been actively collected the reccommendation is to drop <code class="highlighter-rouge">Processor</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">to_be_dropped</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'Processor'</span><span class="p">)</span>

<span class="n">corr_compare</span><span class="p">(</span><span class="n">decode</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="p">[</span><span class="s">'OsBuild'</span><span class="p">,</span> <span class="s">'Census_OSVersion'</span><span class="p">,</span> <span class="s">'Census_OSBuildNumber'</span><span class="p">]))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>17134    1841259
16299    1481190
14393     526492
15063     290713
10586     263100
10240     222567
9600       91900
17692       1864
17738       1243
17744        825
17713        527
17746        423
17735        413
17741        326
17751        324
17758        309
17686        299
17754        268
17677        196
17733        194
17755        192
7601         187
17672        179
17682        123
17760        107
17763         90
17666         78
17661         62
18234         30
17730         24
17704         22
18237         22
17711         19
17723         18
17728         12
17650         10
18242          8
17634          7
17639          6
17627          6
17655          6
18219          4
18204          3
17618          2
17604          2
17133          2
17694          1
17623          1
17643          1
17761          1
18224          1
18230          1
7600           1
Name: OsBuild, dtype: int64
10.0.17134.228      688262
10.0.17134.165      494194
10.0.16299.431      383916
10.0.16299.371      220899
10.0.16299.547      204454
10.0.17134.285      191740
10.0.14393.2189     187287
10.0.17134.112      180003
10.0.10240.17443    173181
10.0.10586.1176     149138
10.0.16299.125      127831
10.0.16299.611      107819
10.0.16299.492      103323
10.0.16299.309       98830
10.0.17134.191       93206
10.0.16299.192       52734
10.0.16299.248       49250
10.0.17134.137       44841
10.0.17134.167       40925
10.0.17134.254       37098
10.0.17134.286       35855
10.0.17134.48        35663
10.0.14393.693       34218
10.0.15063.1206      33752
10.0.15063.1088      32228
10.0.14393.2214      30921
10.0.17134.81        30604
10.0.15063.1266      28195
10.0.16299.15        24735
10.0.15063.786       24315
                     ...  
10.0.16170.1000          1
10.0.14295.1000          1
10.0.17115.1             1
10.0.14295.1004          1
10.0.14946.1000          1
10.0.15019.1000          1
10.0.18230.1000          1
10.0.16299.201           1
10.0.14390.0             1
10.0.14393.1797          1
10.0.18224.1000          1
10.0.16291.0             1
10.0.17093.1000          1
10.0.10586.11            1
10.0.14965.1001          1
10.0.10240.16498         1
10.0.15031.0             1
10.0.15046.0             1
10.0.14316.1000          1
10.0.16237.1001          1
10.0.15055.0             1
10.0.17694.1000          1
10.0.14366.0             1
10.0.17083.1000          1
10.0.14332.1001          1
10.0.16257.1000          1
6.2.9200.21703           1
10.0.18214.1000          1
10.0.14379.0             1
10.0.16199.1000          1
Name: Census_OSVersion, Length: 372, dtype: int64
17134    1898371
16299    1450686
14393     548563
15063     300119
10586     295642
10240     223784
17692       1813
17738       1586
17744        896
17746        434
17735        400
17758        398
17741        348
17751        330
17754        301
17686        296
17733        195
17677        191
17755        179
17763        176
17672        169
17760        122
17682        114
17666         75
17661         59
17713         52
17133         50
18237         29
18234         25
14986         19
          ...   
14332          1
14316          1
14257          1
17694          1
16170          1
14942          1
16257          1
17643          1
17115          1
17107          1
17093          1
17083          1
17035          1
17761          1
16291          1
16278          1
16275          1
16237          1
14946          1
16215          1
16199          1
16193          1
15060          1
15055          1
15046          1
15031          1
15019          1
18214          1
14965          1
7600           1
Name: Census_OSBuildNumber, Length: 116, dtype: int64
</code></pre></div></div>

<p>Both <code class="highlighter-rouge">OsBuild</code> and <code class="highlighter-rouge">Census_OSBuildNumber</code> are present in <code class="highlighter-rouge">Census_OSVersion</code>.</p>

<p>Reccommendation is to drop <code class="highlighter-rouge">OSBuild</code> and <code class="highlighter-rouge">Census_OSBuildNumber</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">to_be_dropped</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'OsBuild'</span><span class="p">)</span>
<span class="n">to_be_dropped</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'Census_OSBuildNumber'</span><span class="p">)</span>

<span class="n">corr_compare</span><span class="p">(</span><span class="n">decode</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="p">[</span><span class="s">'OsBuildLab'</span><span class="p">,</span> <span class="s">'IeVerIdentifier'</span><span class="p">]))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>17134.1.amd64fre.rs4_release.180410-1804                 1707236
16299.431.amd64fre.rs3_release_svc_escrow.180502-1908     781080
16299.15.amd64fre.rs3_release.170928-1534                 524553
15063.0.amd64fre.rs2_release.170317-1834                  260155
14393.2189.amd64fre.rs1_release.180329-1711               162191
16299.15.x86fre.rs3_release.170928-1534                   157883
10240.17443.amd64fre.th1.170602-2340                      144483
17134.1.x86fre.rs4_release.180410-1804                    134020
10586.1176.amd64fre.th2_release_sec.170913-1848           120838
14393.2189.x86fre.rs1_release.180329-1711                  32228
15063.0.x86fre.rs2_release.170317-1834                     30558
10586.1176.x86fre.th2_release_sec.170913-1848              30023
9600.19067.amd64fre.winblue_ltsb_escrow.180619-2033        28385
9600.19101.amd64fre.winblue_ltsb_escrow.180718-1800        28294
10240.17443.x86fre.th1.170602-2340                         27738
14393.693.amd64fre.rs1_release.161220-1747                 26281
14393.2214.amd64fre.rs1_release_1.180402-1758              24363
10240.16384.amd64fre.th1.150709-1700                       19310
14393.0.amd64fre.rs1_release.160715-1616                   19148
14393.2007.amd64fre.rs1_release.171231-1800                18457
14393.1593.amd64fre.rs1_release.170731-1934                16945
14393.1944.amd64fre.rs1_release.171129-2100                15687
14393.1770.amd64fre.rs1_release.170917-1700                14870
14393.1198.amd64fre.rs1_release_sec.170427-1353            13651
10586.672.amd64fre.th2_release_sec.161024-1825             12953
14393.447.amd64fre.rs1_release_inmarket.161102-0100        12946
10586.1106.amd64fre.th2_release.170904-1742                12757
14393.1358.amd64fre.rs1_release.170602-2252                12631
14393.2068.amd64fre.rs1_release.180209-1727                12571
16299.637.amd64fre.rs3_release_svc.180808-1748             12505
                                                          ...   
18204.1001.x86fre.rs_prerelease.180721-1657                    1
9600.18066.x86fre.winblue_ltsb.150928-1002                     1
17761.1.amd64fre.rs5_release.180912-1340                       1
16299.431.amd64fre.rs3_release_svc_escrow.180502-1934          1
7601.24094.x86fre.win7sp1_ldr_escrow.180330-1600               1
7601.19018.amd64fre.win7sp1_gdr.150928-1507                    1
7601.23564.amd64fre.win7sp1_ldr.160930-0600                    1
17694.1000.x86fre.rs_prerelease.180612-1636                    1
17711.1000.x86fre.rs_prerelease.180703-1539                    1
7600.16792.x86fre.win7_gdr.110408-1633                         1
10240.16425.amd64fre.th1.150802-1600                           1
9600.18423.x86fre.winblue_ltsb.160723-0600                     1
9600.17328.x86fre.winblue_r3.140827-1500                       1
7601.24000.x86fre.win7sp1_ldr.171231-1547                      1
7601.23807.amd64fre.win7sp1_ldr.170512-0600                    1
7601.17790.x86fre.win7sp1_gdr.120305-1505                      1
16299.0.x86fre.rs3_release.170922-1354                         1
18230.1000.amd64fre.rs_prerelease.180824-1526                  1
17623.1002.amd64fre.rs_prerelease.180310-1600                  1
14393.1670.amd64fre.rs1_release_inmarket.170821-1825           1
7601.18717.amd64fre.win7sp1_gdr.150113-1808                    1
9600.18146.amd64fre.winblue_ltsb.151121-0600                   1
17618.1000.x86fre.rs_prerelease.180302-1651                    1
9600.17630.x86fre.winblue_r7.150109-2022                       1
18234.1000.x86fre.rs_prerelease.180831-1440                    1
10586.456.x86fre.th2_release.160617-1853                       1
10240.16390.x86fre.th1_st1.150714-1601                         1
10586.456.amd64fre.th2_release.160617-1853                     1
10240.16387.x86fre.th1_st1.150711-1429                         1
18237.1000.x86fre.rs_prerelease.180907-1621                    1
Name: OsBuildLab, Length: 434, dtype: int64
137.0    1841255
117.0    1121427
98.0      284290
111.0     216571
108.0     190210
53.0      172215
74.0      165616
135.0     121184
94.0       95010
103.0      82740
333.0      75821
107.0      72878
96.0       63991
76.0       36303
105.0      27625
41.0       26890
114.0      21980
323.0      13757
87.0       11905
73.0        7916
42.0        7058
82.0        5266
85.0        4176
91.0        4021
72.0        3787
92.0        3512
68.0        3423
81.0        3305
86.0        3270
88.0        3255
          ...   
140.0          2
89.0           2
216.0          1
321.0          1
13.0           1
388.0          1
383.0          1
43.0           1
347.0          1
345.0          1
336.0          1
141.0          1
146.0          1
395.0          1
324.0          1
54.0           1
213.0          1
165.0          1
320.0          1
318.0          1
313.0          1
312.0          1
306.0          1
304.0          1
303.0          1
297.0          1
287.0          1
184.0          1
202.0          1
429.0          1
Name: IeVerIdentifier, Length: 147, dtype: int64
</code></pre></div></div>

<p>Data does not appear to be a replication.</p>

<p>Reccommendation to keep both columns.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">corr_compare</span><span class="p">(</span><span class="n">decode</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="p">[</span><span class="s">'SkuEdition'</span><span class="p">,</span> <span class="s">'Census_OSEdition'</span><span class="p">,</span> <span class="s">'Census_OSSkuName'</span><span class="p">]))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Home               3123051
Pro                1550842
Enterprise           26954
Enterprise LTSB      13666
Education            10728
Cloud                  272
Invalid                147
Name: SkuEdition, dtype: int64
Core                           1946421
Professional                   1499820
CoreSingleLanguage             1107808
CoreCountrySpecific              77926
ProfessionalEducation            30656
Enterprise                       26900
EnterpriseS                      12955
Education                        10755
ProfessionalN                     9300
CoreN                             1554
EnterpriseSN                       721
Cloud                              422
EnterpriseN                        235
EducationN                         131
ProfessionalEducationN              18
ProfessionalWorkstation             15
CloudN                               6
Home                                 4
ProfessionalWorkstationN             3
ServerStandard                       3
ProfessionalCountrySpecific          2
ServerDatacenter                     2
Pro                                  1
professional                         1
ServerRdsh                           1
Name: Census_OSEdition, dtype: int64
CORE                    1946415
PROFESSIONAL            1530642
CORE_SINGLELANGUAGE     1107682
CORE_COUNTRYSPECIFIC      77871
ENTERPRISE                26922
ENTERPRISE_S              12958
EDUCATION                 10770
PROFESSIONAL_N             9313
CORE_N                     1553
ENTERPRISE_S_N              723
CLOUD                       407
ENTERPRISE_N                234
EDUCATION_N                 128
PRO_WORKSTATION              15
UNLICENSED                    7
CLOUDN                        6
PRO_WORKSTATION_N             3
STANDARD_SERVER               3
PRO_FOR_EDUCATION             2
DATACENTER_SERVER             2
PRO_CHINA                     2
SERVERRDSH                    1
UNDEFINED                     1
Name: Census_OSSkuName, dtype: int64
</code></pre></div></div>

<p>The three fields in this case repeat the same data.</p>

<p>Reccommendatino is to srop <code class="highlighter-rouge">SkuEdition</code> and <code class="highlighter-rouge">Census_OSSkuName</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">to_be_dropped</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'SkuEdition'</span><span class="p">)</span>
<span class="n">to_be_dropped</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'Census_OSSkuName'</span><span class="p">)</span>

<span class="n">corr_compare</span><span class="p">(</span><span class="n">decode</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="p">[</span><span class="s">'Census_OSUILocaleIdentifier'</span><span class="p">,</span> <span class="s">'Census_OSInstallLanguageIdentifier'</span><span class="p">]))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>31     1716280
34      595368
30      284288
49      250379
125     231888
35      193151
119     177478
158     175970
26      131887
148     111460
72      106369
160     102805
109      84074
83       67936
115      62001
120      59840
74       44555
5        43905
64       39401
20       35772
140      28128
28       27180
58       24391
24       19522
105      17547
128      15808
130      12199
44        9567
11        9156
62        8065
        ...   
9            4
75           4
66           3
142          3
150          3
99           3
21           3
69           3
13           3
139          2
46           2
16           1
143          1
141          1
153          1
147          1
45           1
22           1
25           1
87           1
71           1
113          1
57           1
107          1
52           1
106          1
77           1
41           1
89           1
2            1
Name: Census_OSUILocaleIdentifier, Length: 121, dtype: int64
8.0     1735246
9.0      595682
7.0      285264
14.0     249580
29.0     230672
10.0     186466
26.0     176883
37.0     175816
5.0      132601
35.0     111270
18.0     106282
39.0     102846
24.0      84150
20.0      67398
25.0      62130
27.0      59661
19.0      44724
1.0       43254
17.0      39125
3.0       35700
33.0      28110
6.0       27036
15.0      24109
4.0       19501
23.0      17548
30.0      15622
31.0      11860
12.0       9578
2.0        8947
16.0       7886
28.0       5622
36.0       5555
13.0       4440
34.0       4039
21.0       3378
38.0       2392
32.0       2213
22.0       1574
11.0       1500
Name: Census_OSInstallLanguageIdentifier, dtype: int64
</code></pre></div></div>

<p><code class="highlighter-rouge">Census_OSUILocaleIdentifier</code> identifies the locale for the OS UI, ie region. 
<code class="highlighter-rouge">Census_OSInstallLanguageIdentifier</code> indicates the languate at install.</p>

<p>Both fields can be used to draw the same conlcusion but present separate data.</p>

<p>The reccommendation is to keep the fields.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_data</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">to_be_dropped</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p>Now to train the model, the steps that will be taken are:</p>
<ol>
  <li>Separate the labels from the data and create the test/train split</li>
  <li>Create the lightgbm file-type, allows for faster processing</li>
  <li>Create the model and paramaters</li>
  <li>Train the model</li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'HasDetections'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s">'HasDetections'</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model_data</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">free_raw_data</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">model_data</span><span class="o">.</span><span class="n">save_binary</span><span class="p">(</span><span class="s">'./model_data.bin'</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;lightgbm.basic.Dataset at 0x7f0c1424c358&gt;
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">param</span> <span class="o">=</span> <span class="p">{</span><span class="s">'learning_rate'</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s">'boosting_type'</span><span class="p">:</span> <span class="s">'gbdt'</span><span class="p">,</span> <span class="s">'nthread'</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s">'objective'</span><span class="p">:</span> <span class="s">'regression'</span><span class="p">,</span> <span class="s">'metric'</span><span class="p">:</span> <span class="s">'auc'</span><span class="p">,</span> <span class="s">'sub_feature'</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s">'num_leaves'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s">'min_data'</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">'max_depth'</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">'device'</span><span class="p">:</span> <span class="s">'gpu'</span><span class="p">}</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">model_data</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">y_pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;=.</span><span class="mi">5</span><span class="p">:</span>
        <span class="n">y_pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>  
        <span class="n">y_pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
    
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.528106550196163
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([[ 16193, 553117],
       [  4385, 607720]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f0d489c5dd8&gt;
</code></pre></div></div>

<p><img src="../../../../../assets/malware_notebook/output_71_1.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#https://lightgbm.readthedocs.io/en/latest/Parameters-Tuning.html</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">params</span><span class="p">[</span><span class="s">'learning_rate'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'boosting_type'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">'gbdt'</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'nthread'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'objective'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">'regression'</span><span class="p">,</span> <span class="s">'binary'</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'metric'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">'auc'</span><span class="p">,</span> <span class="s">'binary_logloss'</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'sub_feature'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'num_leaves'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">80</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'min_data'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'max_depth'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'max_bin'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">63</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'device'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">'gpu'</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">paramaters</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">params</span><span class="o">.</span><span class="n">values</span><span class="p">())]</span>

<span class="n">paramaters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'learning_rate': 0.1,
 'boosting_type': 'gbdt',
 'nthread': 6,
 'objective': 'regression',
 'metric': 'auc',
 'sub_feature': 0.5,
 'num_leaves': 40,
 'min_data': 80,
 'max_depth': 50,
 'max_bin': 63,
 'device': 'gpu'}
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">accuracy_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">paramaters</span><span class="p">:</span>
    
    <span class="n">model</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">model_data</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="c">#Prediction</span>
    <span class="n">y_pred</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="c">#convert into binary values</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">y_pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;=.</span><span class="mi">5</span><span class="p">:</span>       <span class="c"># setting threshold to .5</span>
            <span class="n">y_pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>  
            <span class="n">y_pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
    
    <span class="n">accuracy</span><span class="o">=</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
    <span class="k">print</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="k">print</span><span class="p">()</span>
    <span class="n">accuracy_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
    
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.6723022815860642

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6723022815860642

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6722049406855338

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6722049406855338

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6759656852164565

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6759656852164565

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6760240897567747

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6760240897567747

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6722057871281472

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6722057871281472

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6722057871281472

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6722066335707605

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6760190111010949

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6760190111010949

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6757447636943834

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6760190111010949

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6723022815860642

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6723022815860642

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6722049406855338

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6722049406855338

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6759656852164565

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6759656852164565

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6760240897567747

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6760240897567747

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6722057871281472

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6722066335707605

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6722057871281472

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6722057871281472

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6760190111010949

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6760190111010949

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6760190111010949

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6760190111010949

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.672094903145804

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.672094903145804

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.672094903145804

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.672094903145804

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6758793480698992

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6758793480698992

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6756364190398801

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6756364190398801

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6721990155872407

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6723522217002493

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6723259819792368

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6723259819792368

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6760477901499473

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6761095804607187

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6761984569351159

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6762103071317023

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.672094903145804

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.672094903145804

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.672094903145804

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.672094903145804

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6758793480698992

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6758878124960322

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6756364190398801

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6756364190398801

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6723522217002493

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6723115924548105

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6723259819792368

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6723259819792368

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6760477901499473

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6761341272965046

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6761984569351159

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6762103071317023

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6672430940863286

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6672430940863286

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6672430940863286

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6672430940863286

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.671570955168167

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.671570955168167

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6715701087255537

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6715701087255537

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6669536107125777

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.666954457155191

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6669527642699644

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6669527642699644

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6708794115530953

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6708794115530953

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6708794115530953

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6708794115530953

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6672430940863286

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6672430940863286

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6672430940863286

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6672430940863286

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6715718016107803

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.671570955168167

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.671570955168167

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6715701087255537

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6669536107125777

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6669536107125777

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6669527642699644

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6669527642699644

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6708794115530953

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6708794115530953

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6708794115530953

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6708794115530953

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'regression', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6669434534012181

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6669248316637253

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6668452660580745

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6668452660580745

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6710977937473284

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6709936813058917

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6710825577802889

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6710825577802889

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6664305091775541

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6666184194377082

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6666937528302925

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6665024567996851

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6704824299674543

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6708184676849371

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.670641561178756

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6707532916037124

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6668452660580745

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6669231387784986

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6668334158614881

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6669713860074572

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6709936813058917

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6709928348632783

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6709953741911183

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6710825577802889

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.5, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6665972583723755

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6665871010610158

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6665354680616041

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6665625542252299

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 40, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6707769919968851

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6707041979321406

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 60, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6706584900310221

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 25, 'max_bin': 63, 'device': 'gpu'}

0.6706356360804628

{'learning_rate': 0.05, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'binary_logloss', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">score_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">paramaters</span><span class="p">),</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">accuracy_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'score'</span><span class="p">])],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">score_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s">'score'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>boosting_type</th>
      <th>device</th>
      <th>learning_rate</th>
      <th>max_bin</th>
      <th>max_depth</th>
      <th>metric</th>
      <th>min_data</th>
      <th>nthread</th>
      <th>num_leaves</th>
      <th>objective</th>
      <th>sub_feature</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>47</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.676210</td>
    </tr>
    <tr>
      <th>63</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.676210</td>
    </tr>
    <tr>
      <th>62</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.676198</td>
    </tr>
    <tr>
      <th>46</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.676198</td>
    </tr>
    <tr>
      <th>61</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.676134</td>
    </tr>
    <tr>
      <th>45</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.676110</td>
    </tr>
    <tr>
      <th>60</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.676048</td>
    </tr>
    <tr>
      <th>44</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.676048</td>
    </tr>
    <tr>
      <th>7</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.676024</td>
    </tr>
    <tr>
      <th>6</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.676024</td>
    </tr>
    <tr>
      <th>23</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.676024</td>
    </tr>
    <tr>
      <th>22</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.676024</td>
    </tr>
    <tr>
      <th>31</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.676019</td>
    </tr>
    <tr>
      <th>30</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.676019</td>
    </tr>
    <tr>
      <th>12</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.676019</td>
    </tr>
    <tr>
      <th>13</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.676019</td>
    </tr>
    <tr>
      <th>29</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.676019</td>
    </tr>
    <tr>
      <th>15</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.676019</td>
    </tr>
    <tr>
      <th>28</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.676019</td>
    </tr>
    <tr>
      <th>21</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.675966</td>
    </tr>
    <tr>
      <th>20</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.675966</td>
    </tr>
    <tr>
      <th>4</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.675966</td>
    </tr>
    <tr>
      <th>5</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.675966</td>
    </tr>
    <tr>
      <th>53</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.675888</td>
    </tr>
    <tr>
      <th>52</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.675879</td>
    </tr>
    <tr>
      <th>37</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.675879</td>
    </tr>
    <tr>
      <th>36</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.675879</td>
    </tr>
    <tr>
      <th>14</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.675745</td>
    </tr>
    <tr>
      <th>39</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.675636</td>
    </tr>
    <tr>
      <th>38</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.10</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>80</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.675636</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>65</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.667243</td>
    </tr>
    <tr>
      <th>66</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.667243</td>
    </tr>
    <tr>
      <th>67</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.667243</td>
    </tr>
    <tr>
      <th>81</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.667243</td>
    </tr>
    <tr>
      <th>82</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.667243</td>
    </tr>
    <tr>
      <th>64</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.5</td>
      <td>0.667243</td>
    </tr>
    <tr>
      <th>115</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.666971</td>
    </tr>
    <tr>
      <th>73</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.666954</td>
    </tr>
    <tr>
      <th>72</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.666954</td>
    </tr>
    <tr>
      <th>88</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.666954</td>
    </tr>
    <tr>
      <th>89</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.666954</td>
    </tr>
    <tr>
      <th>75</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.666953</td>
    </tr>
    <tr>
      <th>74</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.666953</td>
    </tr>
    <tr>
      <th>91</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.666953</td>
    </tr>
    <tr>
      <th>90</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>regression</td>
      <td>0.8</td>
      <td>0.666953</td>
    </tr>
    <tr>
      <th>96</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.666943</td>
    </tr>
    <tr>
      <th>97</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.666925</td>
    </tr>
    <tr>
      <th>113</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.666923</td>
    </tr>
    <tr>
      <th>112</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.666845</td>
    </tr>
    <tr>
      <th>99</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.666845</td>
    </tr>
    <tr>
      <th>98</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.666845</td>
    </tr>
    <tr>
      <th>114</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.5</td>
      <td>0.666833</td>
    </tr>
    <tr>
      <th>106</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.666694</td>
    </tr>
    <tr>
      <th>105</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.666618</td>
    </tr>
    <tr>
      <th>120</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.666597</td>
    </tr>
    <tr>
      <th>121</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.666587</td>
    </tr>
    <tr>
      <th>123</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.666563</td>
    </tr>
    <tr>
      <th>122</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>binary_logloss</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.666535</td>
    </tr>
    <tr>
      <th>107</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>50</td>
      <td>auc</td>
      <td>80</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.666502</td>
    </tr>
    <tr>
      <th>104</th>
      <td>gbdt</td>
      <td>gpu</td>
      <td>0.05</td>
      <td>63</td>
      <td>25</td>
      <td>auc</td>
      <td>60</td>
      <td>6</td>
      <td>40</td>
      <td>binary</td>
      <td>0.8</td>
      <td>0.666431</td>
    </tr>
  </tbody>
</table>
<p>128 rows Ã— 12 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">score_df</span><span class="o">.</span><span class="n">corr</span><span class="p">())</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fe69c06fac8&gt;
</code></pre></div></div>

<p><img src="../../../../../assets/malware_notebook/output_78_1.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># We can see num_leaves and score had the greatest affect on the score, just these two for the next round with </span>
<span class="c"># the top metrics results</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">params</span><span class="p">[</span><span class="s">'learning_rate'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'boosting_type'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">'gbdt'</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'nthread'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'objective'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">'binary'</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'metric'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">'auc'</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'sub_feature'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'num_leaves'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">80</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">240</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'min_data'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">80</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'max_depth'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'max_bin'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">63</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'device'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">'gpu'</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">paramaters_2</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">params</span><span class="o">.</span><span class="n">values</span><span class="p">())]</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>9
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">accuracy_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">paramaters_2</span><span class="p">:</span>
    
    <span class="n">model</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">model_data</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="c">#Prediction</span>
    <span class="n">y_pred</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="c">#convert into binary values</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">y_pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;=.</span><span class="mi">5</span><span class="p">:</span>       <span class="c"># setting threshold to .5</span>
            <span class="n">y_pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>  
            <span class="n">y_pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
    
    <span class="n">accuracy</span><span class="o">=</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
    <span class="k">print</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="k">print</span><span class="p">()</span>
    <span class="n">accuracy_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
    
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.6762610936885006

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6792244892776882

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 160, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6806651346055366

{'learning_rate': 0.1, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 240, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6792634256379003

{'learning_rate': 0.2, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6812669553035978

{'learning_rate': 0.2, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 160, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6815640566608685

{'learning_rate': 0.2, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 240, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6796104671093561

{'learning_rate': 0.3, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 80, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6812356369269055

{'learning_rate': 0.3, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 160, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6806566701794036

{'learning_rate': 0.3, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 240, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 0.2 learning rate appears best, num leaves may be able to futher, just them for last round</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">params</span><span class="p">[</span><span class="s">'learning_rate'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'boosting_type'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">'gbdt'</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'nthread'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'objective'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">'binary'</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'metric'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">'auc'</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'sub_feature'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'num_leaves'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">240</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="mi">720</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'min_data'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">80</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'max_depth'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'max_bin'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">63</span><span class="p">]</span>
<span class="n">params</span><span class="p">[</span><span class="s">'device'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">'gpu'</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">paramaters_3</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">params</span><span class="o">.</span><span class="n">values</span><span class="p">())]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">accuracy_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">paramaters_3</span><span class="p">:</span>
    
    <span class="n">model</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">model_data</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="c">#Prediction</span>
    <span class="n">y_pred</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="c">#convert into binary values</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">y_pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;=.</span><span class="mi">5</span><span class="p">:</span>       <span class="c"># setting threshold to .5</span>
            <span class="n">y_pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>  
            <span class="n">y_pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
    
    <span class="n">accuracy</span><span class="o">=</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
    <span class="k">print</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="k">print</span><span class="p">()</span>
    <span class="n">accuracy_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
    
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.681581831955748

{'learning_rate': 0.2, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 240, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6820363716390938

{'learning_rate': 0.2, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 480, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}

0.6819136374601643

{'learning_rate': 0.2, 'boosting_type': 'gbdt', 'nthread': 6, 'objective': 'binary', 'metric': 'auc', 'sub_feature': 0.8, 'num_leaves': 720, 'min_data': 80, 'max_depth': 50, 'max_bin': 63, 'device': 'gpu'}
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Only a minor improvement by increasing num_leaves, next to see if training numbers help improvae at all</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">num_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">param</span> <span class="o">=</span> <span class="p">{</span><span class="s">'learning_rate'</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s">'boosting_type'</span><span class="p">:</span> <span class="s">'gbdt'</span><span class="p">,</span> <span class="s">'nthread'</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s">'objective'</span><span class="p">:</span> <span class="s">'binary'</span><span class="p">,</span> <span class="s">'metric'</span><span class="p">:</span> <span class="s">'auc'</span><span class="p">,</span> <span class="s">'sub_feature'</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span> <span class="s">'num_leaves'</span><span class="p">:</span> <span class="mi">240</span><span class="p">,</span> <span class="s">'min_data'</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="s">'max_depth'</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s">'max_bin'</span><span class="p">:</span> <span class="mi">63</span><span class="p">,</span> <span class="s">'device'</span><span class="p">:</span> <span class="s">'gpu'</span><span class="p">}</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">accuracy_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">num_list</span><span class="p">:</span>
    
    <span class="n">model</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">model_data</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
    <span class="c">#Prediction</span>
    <span class="n">y_pred</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="c">#convert into binary values</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">y_pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;=.</span><span class="mi">5</span><span class="p">:</span>       <span class="c"># setting threshold to .5</span>
            <span class="n">y_pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>  
            <span class="n">y_pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
    
    <span class="n">accuracy</span><span class="o">=</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
    <span class="k">print</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
    <span class="k">print</span><span class="p">()</span>
    <span class="n">accuracy_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
    
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.6816360042829996

100

0.682136251867464

200

0.6816207683159601

400

0.6811586106490946

500
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">model_data</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="c">#Prediction</span>
<span class="n">y_pred</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c">#convert into binary values</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">y_pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;=.</span><span class="mi">5</span><span class="p">:</span>       <span class="c"># setting threshold to .5</span>
        <span class="n">y_pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>  
        <span class="n">y_pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
    
<span class="n">accuracy</span><span class="o">=</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.6821201694578112
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>              precision    recall  f1-score   support

           0       0.67      0.69      0.68    569310
           1       0.70      0.68      0.69    612105

   micro avg       0.68      0.68      0.68   1181415
   macro avg       0.68      0.68      0.68   1181415
weighted avg       0.68      0.68      0.68   1181415
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span><span class="n">annot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f0d4fd12cf8&gt;
</code></pre></div></div>

<p><img src="../../../../../assets/malware_notebook/output_93_1.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>              precision    recall  f1-score   support

           0       0.67      0.69      0.68    569310
           1       0.70      0.68      0.69    612105

   micro avg       0.68      0.68      0.68   1181415
   macro avg       0.68      0.68      0.68   1181415
weighted avg       0.68      0.68      0.68   1181415
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">filename</span> <span class="o">=</span> <span class="s">'finalized_model.sav'</span>
<span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">))</span>
</code></pre></div></div>

  </div><a class="u-url" href="/jekyll/update/2019/03/11/ModelCreation.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Iron Rain Reports</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Iron Rain Reports</li><li><a class="u-email" href="mailto:adyoung@ironraininc.com">adyoung@ironraininc.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/iron-rain-inc"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">iron-rain-inc</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Iron Rain Inc machine learning reports, microsoft, anti-malware, detections</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
